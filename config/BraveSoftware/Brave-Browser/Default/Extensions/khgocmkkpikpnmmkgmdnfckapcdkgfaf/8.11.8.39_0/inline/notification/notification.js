
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="dd7c4fae-ea34-57fc-baa7-043291490978")}catch(e){}}();
import{a as Rr,b as Nr,c as zr}from"/chunks/chunk-AYMQNQJ4.js";import{b as ei}from"/chunks/chunk-TD2M4TOM.js";import{a as ri,b as T,c as ii}from"/chunks/chunk-NMYI6ITX.js";import{a as Qr}from"/chunks/chunk-P7DVCX4B.js";import{a as oi}from"/chunks/chunk-FU2A4ZD4.js";import{a as $r,c as Nn,d as ln,e as de,f as Xr,g as Yr,h as b,i as Jr}from"/chunks/chunk-ZITCEVDD.js";import"/chunks/chunk-YUOMCGI6.js";import{a as O,b as Q}from"/chunks/chunk-OZB4FKQX.js";import"/chunks/chunk-YUOMCGI6.js";import{a as Zr,c as ni}from"/chunks/chunk-KZ7O6TEE.js";import"/chunks/chunk-OK4UQCTS.js";import"/chunks/chunk-NC7PITUF.js";import{b as Cr,c as Br,d as lr,e as dr}from"/chunks/chunk-R5KLIN6L.js";import{A as Ar,Bc as Gr,C as bn,Da as cn,Db as uo,Ea as Vn,Ec as le,Fa as x,Fb as Hn,Fc as Kr,Ga as Un,Gb as Xe,Ha as I,Hb as Fr,Ia as C,Ib as Vr,J as ko,K as qr,Ka as v,La as xn,N as Dr,O as jr,S as Ur,Ua as Hr,Va as on,Za as Mr,b as Ra,c as _r,cb as go,d as cr,f as Fn,g as Ne,ib as Wr,j as Lr,jc as mr,k as Ce,kb as Ae,la as se,lc as fo,na as Pe,r as ze,s as po,w as Le,xa as xo,xb as Or,y as Pr,zb as Be}from"/chunks/chunk-U774LSRJ.js";import{a as h,b as c}from"/chunks/chunk-EXMDW5FT.js";import{i as lo}from"/chunks/chunk-JP74F4RL.js";import{a as $e}from"/chunks/chunk-YVQAWSEC.js";import{M as En,R as Er,T as k,U as Rn,a as te,b as _o,l as sr,m as Tr,n as co,o as Re,q as mo}from"/chunks/chunk-UC3RRRGX.js";import{c as a}from"/chunks/chunk-54UHBIHR.js";var Ee=a(h()),Ta=a(Ra());var pr=n=>n.endsWith("-exit"),ai=n=>n.slice(1),bo=n=>{let e;pr(n)?e=ai(n.split("-exit")[0]):e=ai(n);let o=Object.values(O).find(i=>i===e);if(!o)throw new Error("Invalid notification type provided to notification component.");return o};var To=a(h());var Ni=a(h());var pn=a(h());var ho=a(h());var _e=a(h());var si=a(c()),ti=({children:n})=>{let[e,o]=(0,_e.useState)(),i=(0,_e.useContext)(T);return(0,_e.useEffect)(()=>{i.getAppConfiguration().then(r=>{o({...r,appTheme:r.appTheme})})},[i]),ln("lock-state-changed",r=>{o(s=>s&&{...s,locked:r.locked})},[]),ln("app-theme-changed",r=>{o(s=>s&&{...s,appTheme:r.appTheme})},[]),ln("update-connectivity-status",r=>{o(s=>s&&{...s,connectivityStatus:r})},[]),ln("language-changed",r=>{let s=r;s&&o(t=>t&&{...t,locale:s})},[]),e?(0,si.jsx)(F.Provider,{value:e,children:n}):null},F=(0,_e.createContext)({});function dn(n){let e=(0,ho.useContext)(F);return(0,ho.useCallback)(()=>e?e.unleashFeatures[n]:!1,[n,e])}var _i=a($e()),me=a(h());var vo=a(h());var wo=(n=0)=>{let[e,o]=Le(),i=(0,vo.useContext)(T);return(0,vo.useEffect)(()=>{e?.height&&i.resizeNotification(e.height+n)},[i,e?.height,n]),{measured:e!==void 0,resizeRef:o}};var li=a(h()),mn=a(c()),qe=({close:n,title:e,titleId:o,hideCloseButton:i,actions:r})=>{let s=(0,li.useContext)(b);return(0,mn.jsxs)(x,{display:"flex",flexDirection:"row",alignItems:"center",gap:"xs",padding:"medium",id:"notification-title-bar",children:[(0,mn.jsx)(x,{flexShrink:"0",children:(0,mn.jsx)(Qr,{size:"small"})}),(0,mn.jsx)(v,{grow:"1",wrap:"wrap",children:(0,mn.jsx)(Wr,{as:"h1",id:o,variant:"small",children:e})}),(0,mn.jsxs)(v,{gap:"xs",wrap:"nowrap",children:[r&&r.length>0&&r.map((t,l)=>t.useTooltip?(0,mn.jsxs)(Be,{children:[(0,mn.jsx)(Be.Trigger,{children:(0,mn.jsx)(C.Tertiary,{color:"neutral",onClick:t.onClick,ariaLabel:t.label,disabled:t.disabled,startAccessory:t.icon})}),(0,mn.jsx)(Be.Content,{portal:!1,children:t.label})]},`${t.label}-${l}`):(0,mn.jsx)(C.Tertiary,{color:"neutral",onClick:t.onClick,ariaLabel:t.label,disabled:t.disabled,startAccessory:t.icon},`${t.label}-${l}`)),!i&&(0,mn.jsxs)(Be,{children:[(0,mn.jsx)(Be.Trigger,{children:(0,mn.jsx)(C.Tertiary,{color:"neutral",onClick:n,ariaLabel:s("Close"),startAccessory:(0,mn.jsx)(jr,{})})}),(0,mn.jsx)(Be.Content,{portal:!1,children:s("Close")})]})]})]})};var di={container:"gm"};var yo=a(c()),ci=(0,me.forwardRef)(function({animateOnMount:e,children:o,close:i,hideCloseButton:r,title:s,actions:t,autoFocus:l,focusOptions:m,className:_},d){let{measured:g,resizeRef:p}=wo(),S=le(l,e?m:void 0),R=Fn(S,p,d),w=(0,me.useContext)(T),N=(0,me.useId)();return(0,me.useEffect)(()=>{e&&g&&w.performEnterAnimation()},[e,w,g]),(0,yo.jsxs)("div",{"aria-labelledby":N,ref:R,tabIndex:l?0:void 0,role:"dialog",className:(0,_i.default)(di.container,_),children:[(0,yo.jsx)(qe,{close:i,hideCloseButton:r,title:s,titleId:N,actions:t}),o]})});var Gn=a(h());var pi=a(c()),mi=({children:n})=>{let[e,o]=(0,Gn.useState)(window.location.hash),i=(0,Gn.useContext)(T);(0,Gn.useEffect)(()=>{let s=()=>o(window.location.hash);return window.addEventListener("hashchange",s),()=>window.removeEventListener("hashchange",s)},[]);let r=(0,Gn.useCallback)(s=>void i.notificationExitComplete(s),[i]);return(0,pi.jsx)(Ye.Provider,{value:{exit:pr(e),notifyExitComplete:r},children:n?.(bo(e))})},Ye=(0,Gn.createContext)({});var ki=a($e());var De=a(h());var kr={dialog:"Fi",blur:"Mh"};var Kn=a(c()),xi=(0,De.forwardRef)(function({close:e,title:o,actions:i,autoFocus:r,focusOptions:s,children:t,hideCloseButton:l=!1,blurBackground:m=!1},_){let{exit:d,notifyExitComplete:g}=(0,De.useContext)(Ye),p=(0,De.useId)(),S=le(r,s),R=Fn(S,_);return(0,Kn.jsx)(ze,{propagate:!1,onExitComplete:()=>g({performExitAnimation:!1}),children:d?null:(0,Kn.jsxs)(Kn.Fragment,{children:[(0,Kn.jsx)(uo,{className:(0,ki.default)({[kr.blur]:m})}),(0,Kn.jsxs)(po.div,{ref:R,tabIndex:r?0:void 0,"aria-labelledby":p,role:"dialog",className:kr.dialog,initial:{opacity:0,translateX:"calc(100% + 32px)"},animate:{opacity:1,translateX:0,transition:{type:"tween",ease:cr.Quick,duration:_r.Slow}},exit:{opacity:0,translateX:"calc(100% + 32px)",transition:{type:"tween",ease:cr.Quick,duration:_r.Slow}},children:[(0,Kn.jsx)(qe,{close:e,title:o,titleId:p,actions:i,hideCloseButton:l}),(0,Kn.jsx)(bn,{elevateOnScroll:"top",children:t})]})]})})});var pe=a(h());var gi={container:"Oh"};var fi=a(c()),ui=(0,pe.forwardRef)(function({animateOnMount:e,children:o,autoFocus:i,focusOptions:r},s){let{measured:t,resizeRef:l}=wo(),m=le(i,e?r:void 0),_=Fn(m,l,s),d=(0,pe.useContext)(T),g=(0,pe.useId)();return(0,pe.useEffect)(()=>{e&&t&&d.performEnterAnimation()},[e,d,t]),(0,fi.jsx)("div",{"aria-labelledby":g,ref:_,tabIndex:i?0:void 0,role:"dialog",className:gi.container,children:o})});var So=a(c()),ke=(0,pn.forwardRef)(function(e,o){let{accountUuid:i,children:r,onClose:s,hideCloseButton:t,title:l,actions:m,autoFocus:_,type:d,className:g,closeOnBackForwardCacheLoad:p}=e,R=new URLSearchParams(window.location.search).get("notificationId"),{exit:w,notifyExitComplete:N}=(0,pn.useContext)(Ye),U=(0,pn.useContext)(T),H=dn("b5x-filling-saving-telemetry"),u=(0,pn.useCallback)(()=>{i?k("record-click-event",{accountUuid:i,event:{componentType:"button",category:"app",source:"notification",componentName:`NOTIFICATION_DISMISS_${d}`}}):k("record-click-event-all-accounts",{event:{componentType:"button",category:"app",source:"notification",componentName:`NOTIFICATION_DISMISS_${d}`}})},[i,d]),y=(0,pn.useCallback)(()=>{H()&&d!=="notificationManager"&&u(),s&&s(),U.hideNotification(R??void 0)},[U,H,d,s,R]),A=(0,pn.useMemo)(()=>{if(_)return{preventScroll:!0}},[_]);(0,pn.useEffect)(()=>{_&&lo()&&U.requestFocus(d,A)},[_,U,d,A]),(0,pn.useEffect)(()=>{!w||Q[d].fullscreen||N({performExitAnimation:!0})},[w,d,N]);let P=(0,pn.useRef)(null),$=Fn(P,o),M=[{},{},P],G=[{close:{key:"Escape"}},{close:y},P],en=Q[d].fullscreen&&Q[d].disableKeyboardClose||d==="notificationManager"?M:G;Ne(...en);let yn=(0,pn.useCallback)(q=>{q.persisted&&y()},[y]);return(0,pn.useEffect)(()=>{p&&window.addEventListener("pageshow",yn)},[p,yn]),(0,pn.useEffect)(()=>{!H()||d==="notificationManager"||(i?k("record-view-event",{accountUuid:i,event:{componentType:"notification",category:"app",source:"notification",componentName:`NOTIFICATION_VIEW_${d}`}}):k("record-view-event-all-accounts",{event:{componentType:"notification",category:"app",source:"notification",componentName:`NOTIFICATION_VIEW_${d}`}}))}),d==="notificationManager"?(0,So.jsx)(ui,{animateOnMount:!0,autoFocus:_||!1,focusOptions:A,ref:$,children:r}):Q[d].fullscreen?(0,So.jsx)(xi,{close:y,title:l,autoFocus:_||!1,focusOptions:A,actions:m,ref:$,hideCloseButton:t,blurBackground:Q[d].blurBackground,children:r}):(0,So.jsx)(ci,{animateOnMount:!0,autoFocus:_||!1,focusOptions:A,close:y,hideCloseButton:t,title:l,actions:m,ref:$,className:g,children:r})});var bi=a(c()),xe=({children:n,paddingBottom:e="medium"})=>(0,bi.jsx)(x,{paddingLeft:"medium",paddingRight:"medium",paddingBottom:e,children:n});var Ei=a($e()),gn=a(h());var $n={notificationScroller:"Gh",notificationStack:"Dh",expandButton:"um",collapseButton:"Ji",expandedNotification:"fm",blurBackground:"Ph"};var hi={initial:{opacity:0},animate:n=>({opacity:1,x:0,y:0,transition:{opacity:{duration:.6,ease:"easeOut",delay:n*.2},x:{x:{keyframes:["100%","0px"]},duration:.6,ease:"easeOut",delay:n*.4},y:{duration:.6,ease:[.4,0,.2,1],times:[0,.6,1],keyframes:["15px","25px","0px"],delay:n*.4}}}),exit:{opacity:0}},vi=(n,e,o)=>{if(o.length===0)return[];let i=e.length>0?Io(e[0].type):Number.MAX_SAFE_INTEGER,s=Math.min(...o.map(t=>Io(t.type)))<=i;return n.length===0?[0,1,2]:s?[]:[2]},Io=n=>Q[n]?.priority??5,Co=n=>[...n].sort((e,o)=>{let i=Io(e.type),r=Io(o.type);return i===r?new Date(o.created).getTime()-new Date(e.created).getTime():i-r}),wi=(n,e)=>{let o=n.map(t=>t.id),i=e.filter(t=>!o.includes(t.id)),r=e.filter(t=>o.includes(t.id)),s=Co(r);return{newNotifications:i,previousNotificationsSorted:s,currentNotifications:o}},yi=(n,e=24)=>Array.from(n.values()).reduce((i,r)=>i+r,0)+n.size*e,Si=(n,e,o)=>{switch(n){case"view":o?k("record-click-event",{accountUuid:o,event:e}):k("record-view-event-all-accounts",{event:e});break;case"click":k("record-click-event-all-accounts",{event:e});break}},Ii=(n,e)=>Si("view",n,e),Ci=(n,e)=>Si("click",n,e);var Bi=a(h()),Ti=a(c()),Je=({state:n,children:e})=>n?(0,Ti.jsx)(B.Provider,{value:n,children:e}):null,B=(0,Bi.createContext)({});var Qe={fullscreenNotification:"Jl",collapsedNotification:"bm",animateUnstackedNotification:"Vh",floatRightToLeft:"hm",dismissNotification:"Xh",slideOutRight:"vm"};var ge=a(c()),Ri=({title:n,onClose:e,hideCloseButton:o,closeOnBackForwardCacheLoad:i,accountUuid:r,children:s})=>{let t=(0,gn.useContext)(B),l=dn("b5x-filling-saving-telemetry"),[m,_]=Le(),d=(0,gn.useContext)(T),[g,p]=(0,gn.useState)(!1),S=(0,gn.useRef)(null),R=(0,gn.useRef)(null),w=()=>{p(!0),setTimeout(()=>{e()},150)},N=(0,gn.useCallback)(M=>{M.persisted&&w()},[w]);(0,gn.useEffect)(()=>{i&&window.addEventListener("pageshow",N)},[i,N]);let U=(0,gn.useMemo)(()=>t.autoFocus?{preventScroll:!0}:void 0,[t]),H=le(t.autoFocus,U),u=Fn(R,t.autoFocus?H:null);(0,gn.useEffect)(()=>{t.autoFocus&&lo()&&t?.notification?.type&&d.requestFocus(t.notification.type,U)},[d,t,U]),(0,gn.useEffect)(()=>{let M=t?.notification;l()&&M&&S.current!==M.id&&(Ii({componentType:"notification",category:"app",source:"notification",componentName:`NOTIFICATION_VIEW_${M.type}`},r),S.current=M.id)},[l,t]);let y=[{},{},R],A=[{escape:{key:"Escape"}},{escape:w},R],P=t.notification&&Q[t.notification.type].fullscreen&&Q[t.notification.type].disableKeyboardClose?y:A;if(Ne(...P),!t.notification||!t.orderInStack)return null;let $=()=>(0,ge.jsx)(x,{style:{height:m?.height!==void 0?`${m.height}px`:"auto",transition:"height 50ms ease-in",overflow:"hidden"},children:(0,ge.jsx)(x,{ref:_,children:(0,ge.jsx)(xe,{children:s})})});return(0,ge.jsxs)(x,{className:(0,Ei.default)(t.stackCollapsed?Qe.collapsedNotification:$n.expandedNotification,Qe.animateUnstackedNotification,{[Qe.dismissNotification]:g},{[Qe.fullscreenNotification]:Q[t.notification.type].fullscreen}),"data-testid":"stacked-notification","data-notificationid":t.notification.id,"data-orderinstack":t.orderInStack,boxShadow:"low",borderRadius:"large",role:"alert",tabIndex:0,ref:u,overflow:"visible",children:[(0,ge.jsx)(qe,{close:w,title:n,titleId:t.notification.id,hideCloseButton:o}),Q[t.notification.type].fullscreen?(0,ge.jsx)(bn,{elevateOnScroll:"top",children:$()}):$()]})};var Bo=a(c()),D=({type:n,title:e,onClose:o,hideCloseButton:i,className:r,closeOnBackForwardCacheLoad:s,accountUuid:t,autoFocus:l,children:m})=>{let _=(0,Ni.useContext)(B);return _.notification?(0,Bo.jsx)(Ri,{onClose:o??_.deleteNotification,hideCloseButton:i,title:e,closeOnBackForwardCacheLoad:s,accountUuid:t,children:m}):(0,Bo.jsx)(ke,{onClose:o??_.deleteNotification,hideCloseButton:i,type:n,className:r,title:e,closeOnBackForwardCacheLoad:s,accountUuid:t,autoFocus:l,children:(0,Bo.jsx)(xe,{children:m})})};var Xn=a(c()),qa=()=>{let n=new URLSearchParams(window.location.search),e=(0,To.useContext)(B),o=e.notification?e.notification.params.uuid:n.get("uuid")||"",i=(0,To.useContext)(T),r=(0,To.useContext)(b),s=async()=>{await i.sendAddAccountResponse(o,"YES"),e.deleteNotification()},t=async()=>{await i.sendAddAccountResponse(o,"IGNORE"),e.deleteNotification()};return(0,Xn.jsxs)(D,{title:r("Add account to 1Password browser extension"),type:"addAccount",children:[(0,Xn.jsx)(v,{direction:"row",alignItems:"center",wrap:"nowrap",children:(0,Xn.jsxs)(v,{direction:"column",gap:"medium",children:[(0,Xn.jsx)(I,{as:"p",variant:"medium",children:r("Sign in to websites with one click, easily save your information, and generate new passwords with the browser extension.")}),(0,Xn.jsx)(I,{as:"p",variant:"medium",children:r("You can manage your accounts in Settings.")})]})}),(0,Xn.jsxs)(v,{justifyContent:"flex-end",marginTop:"medium",gap:"medium",children:[(0,Xn.jsx)(C.Secondary,{onClick:t,children:r("Don\u2019t ask again")}),(0,Xn.jsx)(C.Primary,{onClick:s,children:r("Add account")})]})]})},Eo=qa;var ll={login:{priority:0,setting:"autoSaveEnabled",templateUuid:Rr,triggers:[Re.CurrentPassword,Re.NewPassword]},creditCard:{priority:1,setting:"autoSaveCreditCardsEnabled",templateUuid:Nr,triggers:[Re.CcNumber]},identity:{featureFlag:"b5x-autosave-identities",priority:2,setting:"autoSaveIdentitiesEnabled",templateUuid:zr,triggers:[Re.AddressLine1,Re.StreetAddress]}},Ze=(s=>(s.ExpiredSession="expiredSession",s.MissingItem="missingItem",s.MissingSecret="missingSecret",s.Save="save",s.Unknown="unknown",s))(Ze||{});var an=a(h());var gr=a(h());var Ro={successGradient:"Zh",attentionGradient:"wm",brandGradient:"Nh"};var ne=a(c());function ue({vaultIcon:n,title:e,subtitle:o,rowEndElement:i,disabled:r=!1,getCustomIcon:s,color:t}){return(0,ne.jsxs)(x,{className:(m=>{switch(m){case"success":return Ro.successGradient;case"attention":return Ro.attentionGradient;case"brand":return Ro.brandGradient;default:return}})(t),borderColor:"neutral",borderStyle:"solid",borderWidth:"1px",borderRadius:"medium",justifyContent:"space-between",alignItems:"center",padding:"small",width:"full",display:"flex",children:[(0,ne.jsxs)(v,{alignItems:"center",direction:"row",gap:"small",wrap:"nowrap",children:[(0,ne.jsx)(Hr.VaultItem,{size:"medium",name:e,shape:"square",children:n?.sources&&(0,ne.jsx)(cn,{sources:n?.sources,size:"medium",disabled:r,getCustomIcon:s})}),(0,ne.jsxs)(xn,{wrap:"nowrap",marginInlineEnd:"medium",children:[(0,ne.jsx)(I.Medium,{as:"label",color:"neutral",truncate:!0,disabled:r,children:e}),o&&(0,ne.jsx)(I.Small,{as:"label",color:"neutralWeak",truncate:!0,disabled:r,children:o})]})]}),i]})}var zi=a($e()),fe=a(h());var xr={textLabel:"Kh",focused:"Uh"};var hn=a(c()),Li=({items:n,itemAccent:e,selectedItemId:o="",onItemSubmitted:i,onItemSelected:r})=>{let s=(0,fe.useRef)(null),t=(0,fe.useRef)(null),l=(0,fe.useMemo)(()=>n.reduce((w,N)=>(N.type==="option"&&w.push(N.data),w),[]),[n]),m=(0,fe.useMemo)(()=>l.map(w=>w.id),[l]),[_,d]=Ar(m),g=(0,fe.useContext)(b),p=()=>{t.current?.querySelector("div[aria-selected=true]")?.scrollIntoView({block:"center"})};Ne({next:[{key:"ArrowDown"},{key:"n",modifiers:{ctrl:!0},os:"macos"}],previous:[{key:"ArrowUp"},{key:"p",modifiers:{ctrl:!0},os:"macos"}],submitWithEnter:{key:"Enter"},selectWithSpace:{key:" "}},{next:()=>{d.next(),p()},previous:()=>{d.previous(),p()},submitWithEnter:i,selectWithSpace:()=>{let w=l.find(N=>N.id===_);w&&r(w.id)}},s);let S=()=>{_||d.entry(m[0])},R=w=>{d.entry(w),r(w)};return(0,hn.jsx)(x,{display:"flex",maxHeight:"300px",children:(0,hn.jsx)(bn,{elevateOnScroll:"top",ref:t,thin:!0,children:(0,hn.jsx)(x,{role:"listbox",ariaActiveDescendant:_,ariaLabel:g("Existing items"),onBlur:()=>d.none(),onFocus:S,ref:s,tabIndex:0,paddingX:"xs",outline:"none",children:n.map(w=>{switch(w.type){case"header":return(0,hn.jsx)(Ua,{...w.data},w.data.id);case"option":return(0,hn.jsx)(Ha,{data:w.data,selected:o===w.data.id,focused:_===w.data.id,onSelect:R,itemAccent:e},w.data.id);case"separator":return(0,hn.jsx)(Ma,{},w.data.id)}})})})})},Ua=({accountIcon:n,vaultIcon:e,accountLabel:o,vaultLabel:i})=>(0,hn.jsx)(Ae,{paddingBottom:"small",children:(0,hn.jsx)(fo,{items:[{icon:n,text:o},{icon:e,text:i}]})}),Ha=({data:n,focused:e,selected:o,onSelect:i,itemAccent:r})=>(0,hn.jsxs)(x,{role:"option",ariaSelected:e,id:n.id,display:"flex",alignItems:"center",overflow:"hidden",padding:"xs",marginBottom:"2xs",backgroundColor:o?"brandWeak":void 0,borderRadius:"medium",className:(0,zi.default)({[xr.focused]:e}),onClick:()=>i(n.id),children:[(0,hn.jsx)(Vn,{className:xr.textLabel,icon:(0,hn.jsx)(cn,{...n.icon,size:"medium",getCustomIcon:Wa}),label:n.label,secondaryLabel:n.subtitle}),r(n.id)]}),Ma=()=>(0,hn.jsx)(x,{borderTopWidth:"1px",borderStyle:"solid",borderColor:"neutral",margin:"small"}),Wa=async n=>{let e=await k("get-custom-icon-url",{itemId:n});if(e.ok)return e.data;if(e.type==="nolistener"){let o="No listener registered for GetCustomIconUrl";throw new Error(o)}throw e.error};var Yn=a(h()),Pi=a(c()),Oa=n=>n.filter(e=>e.type==="option").map(e=>e.data),Fa=n=>{for(let e of n)if(e.type==="header")return e.data},no=(0,Yn.createContext)({}),No=({updateableItems:n,children:e})=>{let o=(0,Yn.useMemo)(()=>Oa(n),[n]),i=(0,Yn.useMemo)(()=>Fa(n),[n]),r=(0,Yn.useMemo)(()=>o.find(l=>!!l.isDefault),[o]),[s,t]=(0,Yn.useState)(r?.id??o[0]?.id);return(0,Yn.useEffect)(()=>{(!s||!o.some(l=>l.id===s))&&t(r?.id??o[0]?.id)},[r,o,s]),(0,Pi.jsx)(no.Provider,{value:{updateableItems:n,itemListOptions:o,defaultAccount:i,updateItemId:s,setUpdateItemId:t},children:e})};var vn=a(c()),zo=({calloutBanner:n,isDisabled:e,buttonLabel:o="save",onUpdate:i,vaultItemRowProps:r,itemListAttachment:s})=>{let t=(0,gr.useContext)(b),l=(0,gr.useContext)(no),m=async d=>{let g=await k("get-custom-icon-url",{itemId:d});if(g.ok)return g.data;if(g.type==="nolistener"){let p="No listener registered for GetCustomIconUrl";throw new Error(p)}else throw g.error},_=l.itemListOptions.length===1;return(0,vn.jsx)(vn.Fragment,{children:!e&&(0,vn.jsxs)(vn.Fragment,{children:[_?(0,vn.jsx)(ue,{rowEndElement:r?.rowEndElement,vaultIcon:l.itemListOptions[0].icon,title:l.itemListOptions[0].label,subtitle:l.itemListOptions[0].subtitle,disabled:e,getCustomIcon:m,color:r?.color}):(0,vn.jsx)(Li,{items:l.updateableItems,itemAccent:d=>(0,vn.jsx)(Gr,{checked:l.updateItemId===d,tabIndex:-1,readOnly:!0}),selectedItemId:l.updateItemId,onItemSelected:l.setUpdateItemId,onItemSubmitted:()=>{l.updateItemId&&i(l.updateItemId)}}),n||null,(0,vn.jsxs)(x,{display:"flex",width:"full",paddingLeft:"small",gap:"small",justifyContent:_&&l.defaultAccount?"space-between":"flex-end",children:[_&&l.defaultAccount&&(0,vn.jsx)(fo,{items:[{icon:l.defaultAccount.accountIcon,text:l.defaultAccount.accountLabel},{icon:l.defaultAccount.vaultIcon,text:l.defaultAccount.vaultLabel}]}),(0,vn.jsxs)(Ae,{gap:"small",children:[!_&&s,(0,vn.jsx)(C.Primary,{disabled:!l.updateItemId||e,onClick:()=>{l.updateItemId&&i(l.updateItemId)},children:t(o==="save"?"Save":"Update")})]})]})]})})};var Mn=a(h());var zn=n=>{let[e,o]=(0,Mn.useState)(!1),[i,r]=(0,Mn.useState)(void 0),s=(0,Mn.useContext)(T),t=(0,Mn.useRef)(n),l=Pr(n),m=l===!0&&!n,_=l===!1&&n;return(0,Mn.useEffect)(()=>{t.current=n},[n]),(0,Mn.useEffect)(()=>{m&&r(e?"connected":"disconnected")},[e,m]),(0,Mn.useEffect)(()=>{let d=({name:p})=>(o(p==="yes"),r(p==="yes"?"connected":"disconnected"),p);s.canRequestUnlock().then(d);let g=s.on("can-request-unlock-changed",d);return()=>g()},[s]),{locked:n,requestUnlockStatus:i,wasLockedNowUnlocked:m,wasUnlockedNowLocked:_}};var Ai=a(h()),Lo=a(c()),Po=({error:n})=>{let e=(0,Ai.useContext)(b),o=i=>{switch(i){case"expiredSession":return e("Session expired for tab.");case"missingItem":return e("Failed to load item.");case"missingSecret":return e("Invalid one-time password secret.");case"unknown":return e("1Password encountered a problem.");case"save":return e("Failed to save item.");default:te(i)}};return(0,Lo.jsx)(Hn,{icon:{id:"error-callout-banner-icon",sources:[{type:"ThemedIcon",content:{file:En.Warning}}]},role:"alert",variant:"warning",children:(0,Lo.jsx)(v,{alignItems:"flex-start",direction:"column",gap:"small",children:(0,Lo.jsx)(I,{as:"p",variant:"medium",color:"critical",children:o(n)})})})};var je=a(h());var qi=a(c()),Ao=({title:n,username:e,icon:o,rowEndElement:i})=>(0,qi.jsx)(ue,{color:"success",rowEndElement:i,vaultIcon:o,title:n,subtitle:e});var qo=a(c()),Do=({preview:n})=>{let e=(0,je.useRef)(null),o=(0,je.useContext)(B);return(0,je.useEffect)(()=>{e.current=setTimeout(o.deleteNotification,3500)},[o]),(0,qo.jsx)(Ao,{title:n.title,username:n.subtitle,icon:n.icon,rowEndElement:(0,qo.jsx)(x,{children:(0,qo.jsx)(qr,{color:"success"})})})};var Di=a(h()),ee=a(c()),jo=({canRequestUnlock:n,itemCopy:e})=>{let o=(0,Di.useContext)(b);return(0,ee.jsx)(ee.Fragment,{children:(0,ee.jsx)(Hn,{icon:{id:"unlock-callout-banner-icon",sources:[{type:"ThemedIcon",content:{file:En.Lock}}]},role:"status",variant:"info",children:n?(0,ee.jsxs)(v,{alignItems:"flex-start",direction:"column",gap:"small",children:[(0,ee.jsx)(I,{as:"p",variant:"medium",color:"brand",children:o("To save {item}, unlock 1Password first.",{item:e})}),(0,ee.jsx)(C.Primary,{onClick:async()=>k("request-managed-unlock",void 0),children:o("Unlock 1Password")})]}):o("Select the 1Password icon in your browser's toolbar to unlock.")})})};function be(n,e="unknown"){return n.ok?"unknown":n.type==="nolistener"?(console.error("No listener registered for message kind."),"unknown"):Object.values(Ze).find(o=>n.error.message===o)??e}var X=a(c()),Uo=()=>{let n=(0,an.useContext)(b),e=(0,an.useContext)(F),o=(0,an.useContext)(B),i=new URLSearchParams(window.location.search),r=o.notification?o.notification.params.secret:i.get("secret"),{locked:s,requestUnlockStatus:t,wasLockedNowUnlocked:l,wasUnlockedNowLocked:m}=zn(e.locked),[_,d]=(0,an.useState)(),[g,p]=(0,an.useState)(),[S,R]=(0,an.useState)(),[w,N]=(0,an.useState)(),[U,H]=(0,an.useState)(!1),u=(0,an.useCallback)(()=>{k("autosave-2fa-configuration",void 0).then(M=>{M.ok?(d(M.data),H(!1)):p(be(M))})},[]);ln("accounts-and-vaults-changed",u,[u]),(0,an.useEffect)(u,[u]),(0,an.useEffect)(()=>{if(l){H(!0),u();return}m&&d(void 0)},[u,l,m]);let y=dn("b5x-filling-saving-telemetry"),A=(M,G)=>{if(!r)return p("missingSecret");p(void 0),y()&&k("record-click-event-first-account",{event:{componentType:"button",componentName:G?"overwrite":"save",source:"autosave_2fa_notification",category:"autosave_2fa"}}),k("autosave-2fa-save",{id:M,overwrite:G,secret:r}).then(en=>{if(!en.ok)return p(be(en));switch(en.data.type){case"success":R(en.data.data);return;case"overwrite":N(M);return;default:te(en.data)}})},P=()=>s||U?(0,X.jsx)(jo,{canRequestUnlock:t?t==="connected":void 0,itemCopy:n("one-time password")}):S?(0,X.jsx)(Do,{preview:S}):w?(0,X.jsx)(Ka,{onCancel:()=>N(void 0),onOverwrite:()=>A(w,!0)}):_?_.updatableItemListElements.length===0?(0,X.jsx)(Va,{}):(0,X.jsx)(zo,{isDisabled:!1,calloutBanner:_.firstRun?(0,X.jsx)(Ga,{}):void 0,onUpdate:M=>A(M,!1)}):(0,X.jsx)(v,{alignItems:"center",justifyContent:"center",paddingTop:"medium",paddingBottom:"medium",children:(0,X.jsx)(Un.Indeterminate,{})}),$=(0,an.useMemo)(()=>n(S?"Saved one-time password":"Save one-time password"),[n,S]);return(0,X.jsx)(D,{title:$,type:"autosaveTotp",closeOnBackForwardCacheLoad:!0,children:(0,X.jsxs)(v,{direction:"column",gap:"medium",children:[(0,X.jsx)(No,{updateableItems:_?_.updatableItemListElements:[],children:P()}),!!g&&(0,X.jsx)(Po,{error:g})]})})},Va=()=>{let n=(0,an.useContext)(b);return(0,X.jsx)(on.Informational,{title:n("No logins found"),children:(0,X.jsx)(on.Content,{children:n("Make sure 1Password accounts containing logins for this site are unlocked.")})})},Ga=()=>{let n=(0,an.useContext)(b);return(0,X.jsx)(on.Informational,{title:n("Use 1Password for two-factor authentication"),children:(0,X.jsx)(on.Content,{children:n("Save one-time passwords that will be automatically filled during sign-in.")})})},Ka=({onCancel:n,onOverwrite:e})=>{let o=(0,an.useContext)(b);return(0,X.jsxs)(on.Warning,{title:o("Overwrite one-time password?"),children:[(0,X.jsx)(on.Content,{children:o("The one-time password in this item will be replaced.")}),(0,X.jsxs)(on.Actions,{children:[(0,X.jsx)(on.Button,{onClick:n,children:o("Cancel")}),(0,X.jsx)(on.Button,{onClick:e,children:o("Overwrite")})]})]})};var rn=a(h());var He=a(h());var eo=a(h());var ji={vaultItem:"Yh",vaultForItem:"Fh"};var Ue=a(h()),Hi=a(c()),ur=(0,Ue.createContext)({}),Ui=({vaults:n,selectedVaultUuid:e,children:o})=>{let[i,r]=(0,Ue.useState)(e);return(0,Ue.useEffect)(()=>{n.some(t=>t.type==="Vault"&&t.content.id===e)||r(e)},[e,n]),(0,Hi.jsx)(ur.Provider,{value:{vaults:n,accountVaultUuid:i,setAccountVaultUuid:r},children:o})};var Sn=a(c()),Mi=n=>{let e=(0,eo.useContext)(b),o=(0,eo.useContext)(ur),i=(0,eo.useRef)(null);return(0,Sn.jsxs)(Sn.Fragment,{children:[(0,Sn.jsx)(ue,{rowEndElement:n.vaultItemRowProps?.rowEndElement,vaultIcon:n.newVaultItemData.icon,title:n.newVaultItemData.title,subtitle:n.newVaultItemData.username,disabled:n.isDisabled,color:n.vaultItemRowProps?.color}),!n.isDisabled&&(0,Sn.jsxs)(Ae,{gap:"medium",children:[(0,Sn.jsx)(x,{flexGrow:"1",children:(0,Sn.jsx)(ei,{buttonClassName:ji.vaultForItem,vaultListElements:o.vaults,selectedVaultId:o.accountVaultUuid,onSelect:r=>o.setAccountVaultUuid(r.content.id)})}),(0,Sn.jsx)(x,{flexShrink:"0",children:(0,Sn.jsx)(C.Primary,{disabled:!o.accountVaultUuid,onClick:()=>o.accountVaultUuid&&n.onSave(o.accountVaultUuid),children:e("Save")})})]}),!n.isDisabled&&n.isTutorial&&(0,Sn.jsx)(x,{children:(0,Sn.jsx)(oi,{initialPlacement:"bottom",fullDisplay:!0,primaryText:e("Step 3: Review or edit your new login item, then save it."),secondaryText:e("Once saved, we'll remember it for you."),targetRef:i,telemetryEvent:{componentType:"tooltip",category:"extension_save_fill_tutorial",componentName:"REVIEW_LOGIN_ITEM"}})})]})};var he=a(c()),Ho=n=>{let e=(0,He.useContext)(b),o=n.updateableItems.some(t=>t.type==="option"&&!!t.data.isDefault),[i,r]=(0,He.useState)(o?"updatable-item-list":"new-item");(0,He.useEffect)(()=>{n.updateableItems.some(l=>l.type==="option")||r("new-item")},[n.updateableItems]);let s=[{id:"new-item",label:e("New Item")},{id:"updatable-item-list",label:e("Update Existing")}];return(0,he.jsx)(Ui,{selectedVaultUuid:n.newItem.selectedVault,vaults:n.newItem.vaults,children:(0,he.jsxs)(No,{updateableItems:n.updateableItems,children:[n.updateableItems.length>0&&(0,he.jsx)(ze,{children:(0,he.jsx)(Kr,{activeTabId:i,onTabClick:t=>{r(t)},tabs:s})}),i==="new-item"&&(0,he.jsx)(Mi,{vaultItemRowProps:n.vaultItemRowProps,newVaultItemData:n.newItem,onSave:n.onSave,isTutorial:n.isTutorial,isDisabled:n.isDisabled}),i==="updatable-item-list"&&!n.isDisabled&&(0,he.jsx)(zo,{...n.updateItemOpts,isDisabled:n.isDisabled,onUpdate:n.onUpdate})]})})};var Wi=a(h());var ve=a(c()),Oi=({preview:n,onDismiss:e})=>{let o=(0,Wi.useContext)(b);setTimeout(()=>{e()},5e3);let i=async r=>{let s=await k("get-custom-icon-url",{itemId:r});if(s.ok)return s.data;if(s.type==="nolistener"){let t="No listener registered for GetCustomIconUrl";throw new Error(t)}else throw s.error};return(0,ve.jsxs)(ve.Fragment,{children:[(0,ve.jsx)(ue,{vaultIcon:n.icon,title:n.title,subtitle:n.subtitle,getCustomIcon:i}),(0,ve.jsx)(on.Success,{role:"status",children:(0,ve.jsx)(on.Content,{children:o("Fill this item with 1Password next time you log in to save time")})})]})};var Fi={loginDetails:"Ql",lockBanner:"Jh"};var un=a(c()),fr={login:"autosave-save-type-login",creditCard:"autosave-save-type-credit-card",identity:"autosave-save-type-identity"},Mo=()=>{let n=(0,rn.useContext)(F),e=(0,rn.useContext)(B),o=new URLSearchParams(window.location.search),i=e.notification?e.notification.params.tutorialMode:o.get("tutorialMode")==="true",r=(0,rn.useContext)(b),{locked:s,requestUnlockStatus:t,wasLockedNowUnlocked:l,wasUnlockedNowLocked:m}=zn(n.locked),[_,d]=(0,rn.useState)(),[g,p]=(0,rn.useState)(),[S,R]=(0,rn.useState)(),[w,N]=(0,rn.useState)(!1),[U,H]=(0,rn.useState)(),u=(0,rn.useCallback)(()=>{k("autosave-configuration",void 0).then(q=>{q.ok?(d(q.data),H(q.data.saveType),N(!1)):p(be(q))})},[]);ln("accounts-and-vaults-changed",u,[u]),(0,rn.useEffect)(u,[u]),(0,rn.useEffect)(()=>{if(l){N(!0),u();return}m&&d(void 0)},[u,l,m]);let y=dn("b5x-filling-saving-telemetry"),A=(0,rn.useCallback)(q=>{q&&(y()&&k("record-click-event-first-account",{event:{componentType:"button",category:"item",source:"notification",componentName:"AUTOSAVE_SAVE"}}),k("autosave-save",{type:"new",data:{vaultSelector:q}}).then(f=>{f.ok?R(f.data):p(be(f))}))},[y]),P=(0,rn.useCallback)(()=>{k("autosave-dismiss",void 0),e.deleteNotification()},[e]),$=(0,rn.useCallback)(q=>{k("autosave-edit",q).then(f=>{f.ok?e.deleteNotification():p(be(f))})},[e]),M=(0,rn.useCallback)(async q=>k("autosave-save",{type:"update",data:{id:q}}).then(f=>{f.ok?R(f.data):p(be(f))}),[]),G=q=>q===void 0?r("an Item"):q==="identity"?r("an {item}",{item:r.lookup(fr[q]).toLowerCase()}):r("a {item}",{item:r.lookup(fr[q]).toLowerCase()}),en=q=>{let f=q?r.lookup(fr[q]):r("Item");return S?r("{item} saved",{item:f}):_?.duplicateItemPreview?r("{item} already saved",{item:f}):r("Save {item}",{item:f.toLowerCase()})},yn=()=>{if(s||w)return(0,un.jsx)(jo,{canRequestUnlock:t?t==="connected":void 0,itemCopy:G(U)});if(_?.duplicateItemPreview)return(0,un.jsx)(Oi,{preview:_.duplicateItemPreview,onDismiss:P});if(S)return(0,un.jsx)(Do,{preview:S});if(!_)return(0,un.jsx)(v,{alignItems:"center",justifyContent:"center",paddingTop:"medium",paddingBottom:"medium",children:(0,un.jsx)(Un.Indeterminate,{})});let q=f=>({rowEndElement:(0,un.jsx)(C.Tertiary,{color:"neutral",startAccessory:(0,un.jsx)(Ur,{}),disabled:f,onClick:()=>$(void 0),children:r("Edit")})});return(0,un.jsx)(Ho,{vaultItemRowProps:q(s),updateItemOpts:{vaultItemRowProps:q(s),itemListAttachment:(0,un.jsx)(Ya,{onEdit:$,isDisabled:s}),buttonLabel:"update"},isDisabled:s,isTutorial:i,onSave:A,onUpdate:M,updateableItems:_.updatableItemListElements,newItem:{title:_.preview.title,username:_.preview.subtitle,icon:_.preview.icon,vaults:_.vaultListElements,selectedVault:_.defaultSuggestedVaultId}})};return(0,un.jsx)(D,{onClose:P,hideCloseButton:i,type:"autosave",className:Fi.notification,title:en(U),children:(0,un.jsxs)(v,{direction:"column",gap:"medium",children:[yn(),!!g&&(0,un.jsx)(Po,{error:g})]})})},Ya=({onEdit:n,isDisabled:e})=>{let o=(0,rn.useContext)(b),i=(0,rn.useContext)(no);return(0,un.jsx)(C.Secondary,{disabled:!i.updateItemId||e,onClick:()=>n?.(i.updateItemId),children:o("Edit")})};var re=a(h());var oe=a(h());var Vi=a(h());var Wo=a(h());function we(n){let[e,o]=(0,Wo.useState)(!1),i=(0,Wo.useCallback)(async(...r)=>{if(e){console.info(`Can't execute ${n.name} while prior action is in progress - ignoring request`);return}o(!0);try{await n(...r)}catch(s){throw console.warn(`${n.name} failed`),s}finally{o(!1)}},[n,e]);return{isExecuting:e,execute:i}}var Y={recheckingContainer:"Qh",openLinkIcon:"nv",multiSelectionContainer_blocking:"rv",multiSelectionContainer_nonBlocking:"ov",reasonsListContainer:"Gr",reasonsListContainer_individual:"Dr",resolvedIssue:"ym",successNotification:"Bm"};var z=a(c()),Gi=({accountUuid:n,reasons:e,resolvedIssues:o,recheckDevice:i,errorMessage:r,snooze:s})=>{let t=(0,Vi.useContext)(b),{isExecuting:l,execute:m}=we(i),{isExecuting:_,execute:d}=we(s.show?s.onSnooze:async()=>{}),g=p=>{k("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_BLOCKING_FIX_ISSUE"}}),window.open(p,"_blank","noopener")};return(0,z.jsxs)(v,{direction:"column",children:[(0,z.jsx)(v,{gap:"small",direction:"row",wrap:"nowrap",children:e.length===1&&o.length===0?(0,z.jsx)(x,{className:Y.reasonsListContainer_individual,width:"full",children:(0,z.jsxs)(x,{as:"a",tabIndex:0,focusable:"on",htmlFor:e?.[0]?.title,alignItems:"center",justifyContent:"space-between",gap:"small",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",display:"flex",onClick:()=>{g(e?.[0].fixUrl)},onKeyUp:p=>{(p.key==="Enter"||p.key===" ")&&g(e?.[0].fixUrl)},children:[(0,z.jsxs)(v,{alignItems:"center",gap:"small",wrap:"nowrap",direction:"row",children:[(0,z.jsx)(cn,{size:"medium",sources:[{type:"RichIcon",content:{url:e?.[0]?.icon??""}}]}),(0,z.jsx)(xn,{shrink:"1",children:(0,z.jsx)(I,{variant:"medium",as:"span",color:"neutral",children:e[0]?.title})})]}),(0,z.jsx)(x,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:Y.openLinkIcon,children:(0,z.jsx)(se,{ariaLabel:"Navigate",color:"neutralWeak"})})]})}):(0,z.jsx)(x,{display:"flex",className:Y.multiSelectionContainer_blocking,children:(0,z.jsx)(bn,{alwaysShowBorder:!1,thin:!0,children:(0,z.jsxs)(x,{as:"ul",className:Y.reasonsListContainer,children:[e.map(p=>(0,z.jsx)("li",{"aria-label":t("Fix issue: {issue}",{issue:p.title}),children:(0,z.jsxs)(v,{as:"a",tabIndex:0,focusable:"on",htmlFor:p.title,alignItems:"center",justifyContent:"space-between",gap:"small",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",onClick:()=>{g(p.fixUrl)},onKeyUp:S=>{(S.key==="Enter"||S.key===" ")&&g(p.fixUrl)},children:[(0,z.jsxs)(v,{alignItems:"center",gap:"small",wrap:"nowrap",direction:"row",children:[(0,z.jsx)(cn,{size:"medium",sources:[{type:"RichIcon",content:{url:p?.icon??""}}]}),(0,z.jsx)(xn,{shrink:"1",children:(0,z.jsx)(I,{variant:"medium",as:"span",color:"neutral",children:p.title})})]}),(0,z.jsx)(x,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:Y.openLinkIcon,children:(0,z.jsx)(se,{ariaLabel:"Navigate",color:"neutralWeak"})})]})},p.id)),o.map(p=>(0,z.jsx)("li",{"aria-label":t("Resolved issue: {issue}",{issue:p.title}),children:(0,z.jsxs)(x,{as:"div",focusable:"off",alignItems:"center",justifyContent:"space-between",gap:"xs",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",display:"flex",className:Y.resolvedIssue,children:[(0,z.jsxs)(v,{alignItems:"center",gap:"small",wrap:"nowrap",direction:"row",children:[(0,z.jsx)(cn,{size:"medium",sources:[{type:"RichIcon",content:{url:p?.icon??""}}]}),(0,z.jsx)(xn,{shrink:"1",children:(0,z.jsx)(I,{variant:"medium",as:"span",color:"neutral",children:p.title})})]}),(0,z.jsx)(x,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:Y.openLinkIcon,children:(0,z.jsx)(ko,{ariaLabel:"Navigate",color:"success"})})]})},p.id))]})})})}),r?(0,z.jsx)(x,{marginTop:"xs",children:(0,z.jsx)(I.Medium,{as:"span",color:"critical",children:r})}):null,(0,z.jsxs)(v,{direction:"row-reverse",gap:"xs",justifyContent:"space-between",marginTop:"small",children:[(0,z.jsx)(C.Secondary,{disabled:l,onClick:m,ariaLabel:t("Recheck device"),children:l?(0,z.jsx)(x,{className:Y.recheckingContainer,children:(0,z.jsx)(Un,{variant:"indeterminate"})}):t("Recheck")}),s.show&&(0,z.jsx)(C.Tertiary,{onClick:d,disabled:l||_,children:t("Snooze")})]})]})};var br=a(c()),Ki=({accountUuid:n,initialDeviceHealth:e,setInitialDeviceHealth:o,blockedPage:i})=>{let r=(0,oe.useContext)(b),s=(0,oe.useContext)(B),l=new URLSearchParams(window.location.search).get("notificationId"),{deviceHealth:m,getDeviceHealth:_}=de(),[d,g]=(0,oe.useState)(),p=r("Something isn't right. Please try again. If the problem persists, contact your administrator"),S=m?.failingChecks?m?.failingChecks.filter(u=>u.status==="blocked").map(u=>({id:u.id,title:u.title,icon:u.iconUrl,fixUrl:u.endUserUrl,canForceSuccess:u.canForceSuccess})):[],R=e&&m?e?.failingChecks.filter(({id:u})=>!m?.failingChecks.some(({id:y})=>u===y)).filter(u=>u.status==="blocked").map(u=>({id:u.id,title:u.title,icon:u.iconUrl})):[],w=i?r("Fix {count, plural, =1 {# issue} other {# issues}} to use {appName}",{appName:i||"",count:S.length||0}):r("Blocked Device");(0,oe.useEffect)(()=>{_(),d&&d!==p&&g(S.length>0?r("{count, plural, =1{# issue remains} other{# issues remain}}",{count:S.length}):void 0)},[r,d,p,_,S.length]);let N=(0,oe.useCallback)(()=>{s.deleteNotification()},[]),U=async()=>{let u=await k("recheck-device",{deviceStatus:"blocked",activeNotificationId:l});if(k("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_BLOCKING_RECHECK_BUTTON"}}),!u.ok||u.data.type==="failure"){g(p);return}let{health:y}=u.data.data;if(y.device.status!=="blocked")return;let A=y.failingChecks.filter(P=>P.status==="blocked");g(A.length>0?r("{count, plural, =1{# issue remains} other{# issues remain}}",{count:A.length}):void 0),o(void 0)},H=m?.actions.forceSuccess?{show:!0,onSnooze:async()=>{let u=await k("force-device-trust-success",void 0);if(k("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_BLOCKING_IGNORE_BUTTON"}}),!u.ok){g(p);return}if(u.data.type==="failure"){g(u.data.userFacingError||p);return}N()}}:{show:!1};return(0,br.jsx)(D,{onClose:N,title:w,autoFocus:!0,type:"deviceTrustBlocking",closeOnBackForwardCacheLoad:!1,hideCloseButton:!0,accountUuid:n,children:(0,br.jsx)(Gi,{accountUuid:n,recheckDevice:U,reasons:S,resolvedIssues:R,errorMessage:d,snooze:H})})};var wn=a(h());var $i="/assets/png/1password_kolide_icon-KSUCYEQW.png";var Xi=a(h());var Oo={fixRunningContainer:"ev",recheckRunningContainer:"iv"};var Z=a(c()),Yi=({accountUuid:n,errorMessage:e,reason:o,aboutUrl:i,onFixClick:r,showAboutButton:s,onRecheckClick:t,iconUrl:l,fixLabel:m})=>{let _=(0,Xi.useContext)(b),{isExecuting:d,execute:g}=we(r),{isExecuting:p,execute:S}=we(t);return(0,Z.jsxs)(v,{direction:"column",children:[(0,Z.jsx)(v,{gap:"small",direction:"row",wrap:"nowrap",children:(0,Z.jsx)(x,{className:Y.reasonsListContainer_individual,width:"full",children:(0,Z.jsxs)(x,{as:"a",tabIndex:0,focusable:"on",htmlFor:o.title,alignItems:"center",justifyContent:"space-between",gap:"small",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",display:"flex",onClick:g,onKeyUp:R=>{(R.key==="Enter"||R.key===" ")&&g()},disabled:d,children:[(0,Z.jsx)(Vn,{truncate:!1,label:o.title,secondaryLabel:o.subtitle,icon:{size:"small",sources:[{type:"RichIcon",content:{url:l}}]}}),(0,Z.jsx)(x,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:Oo.openLinkIcon,children:d?(0,Z.jsx)(x,{className:Oo.fixRunningContainer,children:(0,Z.jsx)(Un,{variant:"indeterminate"})}):(0,Z.jsx)(se,{ariaLabel:"Navigate",color:"neutralWeak"})})]})})}),e?(0,Z.jsx)(x,{marginTop:"xs",children:(0,Z.jsx)(I.Medium,{as:"span",color:"critical",children:e})}):null,(0,Z.jsxs)(v,{direction:"row",gap:"medium",justifyContent:"flex-end",marginTop:"small",children:[s&&(0,Z.jsx)(C.Tertiary,{ariaLabel:_("About Kolide"),onClick:()=>{k("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_REGISTER_ABOUT_BUTTON"}}),window.open(i)},children:(0,Z.jsx)(x,{display:"flex",gap:"xs",justifyContent:"center",alignItems:"flex-end",children:_("About Kolide")})}),(0,Z.jsx)(C,{ariaLabel:m,onClick:S,disabled:p,children:(0,Z.jsx)(x,{className:Oo.recheckRunningContainer,children:p?(0,Z.jsx)(Un,{inverted:!0,variant:"indeterminate"}):(0,Z.jsx)(Z.Fragment,{children:m})})})]})]})};var hr=a(c()),Ji=n=>{let e=(0,wn.useContext)(b),o=(0,wn.useContext)(B),[i,r]=(0,wn.useState)(),s=n.blockedPage?e("Fix 1 issue to access {appName}",{appName:n.blockedPage||""}):e("Blocked Device"),t=n.accountName?e("{accountName} requires that you set up Kolide on this device before accessing work apps.",{accountName:n.accountName}):e("Your admin requires that you set up Kolide on this device before accessing work apps."),l=n.accountName?e("{accountName} needs 1Password unlocked to check your device's security.",{accountName:n.accountName}):e("Your admin needs 1Password unlocked to check your device's security."),_={title:n.cause==="deviceTrustNoKolide"?e("Kolide is missing or not registered"):e("1Password is locked"),subtitle:n.cause==="deviceTrustNoKolide"?t:l},d=(0,wn.useRef)(void 0);ln("lock-state-changed",({locked:u})=>{u||d.current&&d.current.resolve({type:"unlocked"})},[]);let g=(0,wn.useCallback)(()=>{o.deleteNotification()},[]),p=(0,wn.useCallback)((u,y)=>{k("record-click-event",{accountUuid:u,event:{componentType:"notification",category:"app",source:"notification",componentName:y}})},[]),S=(0,wn.useCallback)(async(u,y)=>{if(r(void 0),u){d.current=dr(),k("request-managed-unlock",void 0);let A=await Promise.race([d.current.promise,lr(3e4)]);if(d.current=void 0,A.type==="timeout")return r(e("Please try unlocking again before fixing this issue")),!1}return y!=="deviceTrustNeedsUnlock"},[e]),R=(0,wn.useCallback)(async()=>{if(p(n.accountUuid,"DT4A_REGISTER_FIX_BUTTON"),!await S(n.locked,n.cause))return;let y=await k("enroll-device",{accountUuid:n.accountUuid});if(!y.ok){r(e("Something isn't right. Please try again. If the problem persists, contact your administrator"));return}if(y.data.type==="failure"){console.error(`DeviceTrust: ${y.data.code.toString()} ${y.data.message.toString()}`),r(n.accountName?e("Ensure you are signed in to the account associated with { accountName }. Please try again. If the problem persists, contact your administrator",{accountName:n.accountName}):e("Something isn't right. Please try again. If the problem persists, contact your administrator"));return}return y.data},[p,n.accountUuid,n.locked,n.cause,S,e]),w=(0,wn.useCallback)(async()=>{if(p(n.accountUuid,"DT4A_REGISTER_RECHECK_BUTTON"),!await S(n.locked,n.cause))return;N.current=dr();let y=await k("kolide-device-registered",{accountUuid:n.accountUuid}),A=await Promise.race([N.current.promise,lr(3e3)]);if(N.current=void 0,!y.ok||A.type==="timeout"){r(e("Kolide wasn't found. Try again, or contact your administrator if the problem persists."));return}return y.ok&&g(),y.data},[p,n.accountUuid,n.locked,n.cause,S,e,g]),N=(0,wn.useRef)(void 0);ln("device-trust-connected",()=>{if(!N.current){g();return}N.current.resolve({type:"agent-found"})},[]);let U=n.cause==="deviceTrustNoKolide"?"https://assets1.kolide.com/assets/kolide-k-logo-a6e31c59.svg":$i,H=n.cause==="deviceTrustNoKolide"&&!n.locked?e("Recheck"):e("Unlock 1Password");return(0,hr.jsx)(D,{onClose:g,title:s,autoFocus:!0,type:"deviceTrustNoKolide",closeOnBackForwardCacheLoad:!1,hideCloseButton:!0,accountUuid:n.accountUuid,children:(0,hr.jsx)(Yi,{accountUuid:n.accountUuid,errorMessage:i,aboutUrl:"https://www.kolide.com/docs/users",reason:_,onFixClick:R,iconUrl:U,fixLabel:H,showAboutButton:n.cause==="deviceTrustNoKolide",onRecheckClick:w})})};var Jn=a(h());var nt=1e3*3600*24,et=n=>Math.floor(n/nt),Qi=(n,e)=>{let o=new Date(n),i=new Date(e);o.setHours(0,0,0,0);let r=o.getTime(),t=i.getTime()-r,l=Math.abs(t);return et(l)},Zi=(n,e)=>n.getFullYear()!==e.getFullYear()||n.getMonth()!==e.getMonth()?!1:n.getDay()===e.getDay(),na=(n,e)=>!n&&!e||n?.length!==e?.length?!1:n?.some(o=>e?.some(i=>o.id===i.id)),ea=(n,e)=>{try{chrome.runtime.sendMessage({name:"report-error",data:{name:"DeviceTrust",message:n.str,severity:"error",stack:e}})}catch{console.error("DeviceTrust: sendMessage failed to send reportable error to sentry")}},Fo=(n,e,o)=>n&&typeof n=="object"&&o in n&&typeof n[o]=="string"?n[o]:e.get(o);var oa=a(h());var E=a(c()),ra=({accountUuid:n,reasons:e,resolvedIssues:o,recheckDevice:i,ignoreWarningNotification:r,errorMessage:s})=>{let t=(0,oa.useContext)(b),{isExecuting:l,execute:m}=we(i),_=d=>{k("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_WARNING_FIX_ISSUE"}}),window.open(d,"_blank","noopener")};return(0,E.jsxs)(v,{direction:"column",children:[(0,E.jsx)(v,{gap:"small",direction:"row",wrap:"nowrap",children:e.length===1&&o.length===0?(0,E.jsx)(x,{className:Y.reasonsListContainer_individual,width:"full",children:(0,E.jsxs)(x,{as:"a",tabIndex:0,focusable:"on",htmlFor:e?.[0]?.title,alignItems:"center",justifyContent:"space-between",gap:"small",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",display:"flex",onClick:()=>{_(e?.[0].fixUrl)},onKeyUp:d=>{(d.key==="Enter"||d.key===" ")&&_(e?.[0].fixUrl)},children:[(0,E.jsxs)(v,{alignItems:"center",gap:"small",wrap:"nowrap",direction:"row",children:[(0,E.jsx)(cn,{size:"medium",sources:[{type:"RichIcon",content:{url:e?.[0]?.icon??""}}]}),(0,E.jsxs)(xn,{shrink:"1",children:[(0,E.jsx)(I,{variant:"medium",as:"span",color:"neutral",children:e[0]?.title}),e[0]?.blockDate&&(0,E.jsx)(I,{variant:"small",as:"span",color:"neutralWeak",children:e[0]?.blockDate})]})]}),(0,E.jsx)(x,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:Y.openLinkIcon,children:(0,E.jsx)(se,{ariaLabel:"Navigate",color:"neutralWeak"})})]})}):(0,E.jsx)(x,{display:"flex",className:Y.multiSelectionContainer_nonBlocking,children:(0,E.jsx)(bn,{alwaysShowBorder:!1,thin:!0,children:(0,E.jsxs)(x,{as:"ul",className:Y.reasonsListContainer,children:[e.map(d=>(0,E.jsx)("li",{"aria-label":t("Fix issue: {issue}",{issue:d.title}),children:(0,E.jsxs)(v,{as:"a",tabIndex:0,focusable:"on",htmlFor:d.title,alignItems:"center",justifyContent:"space-between",gap:"xs",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",onClick:()=>{_(d.fixUrl)},onKeyUp:g=>{(g.key==="Enter"||g.key===" ")&&_(d.fixUrl)},children:[(0,E.jsxs)(v,{alignItems:"center",gap:"small",wrap:"nowrap",direction:"row",children:[(0,E.jsx)(cn,{size:"medium",sources:[{type:"RichIcon",content:{url:d?.icon??""}}]}),(0,E.jsxs)(xn,{shrink:"1",children:[(0,E.jsx)(I,{variant:"medium",as:"span",color:"neutral",children:d.title}),d.blockDate&&(0,E.jsx)(I,{variant:"small",as:"span",color:"neutralWeak",children:d.blockDate})]})]}),(0,E.jsx)(x,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:Y.openLinkIcon,children:(0,E.jsx)(se,{ariaLabel:"Navigate",color:"neutralWeak"})})]})},d.id)),o.map(d=>(0,E.jsx)("li",{"aria-label":t("Resolved issue: {issue}",{issue:d.title}),children:(0,E.jsxs)(x,{as:"div",focusable:"off",alignItems:"center",justifyContent:"space-between",gap:"xs",wrap:"nowrap",paddingInline:"small",paddingBlock:"small",display:"flex",className:Y.resolvedIssue,children:[(0,E.jsxs)(v,{alignItems:"center",gap:"small",wrap:"nowrap",direction:"row",children:[(0,E.jsx)(cn,{size:"medium",sources:[{type:"RichIcon",content:{url:d?.icon??""}}]}),(0,E.jsx)(xn,{shrink:"1",children:(0,E.jsx)(I,{variant:"medium",as:"span",color:"neutral",children:d.title})})]}),(0,E.jsx)(x,{display:"flex",alignItems:"center",gap:"xs",justifyContent:"flex-end",className:Y.openLinkIcon,children:(0,E.jsx)(ko,{ariaLabel:"Navigate",color:"success"})})]})},d.id))]})})})}),s?(0,E.jsx)(x,{marginTop:"xs",children:(0,E.jsx)(I.Medium,{as:"span",color:"critical",children:s})}):null,(0,E.jsxs)(v,{direction:"row-reverse",gap:"xs",justifyContent:"space-between",marginTop:"small",children:[(0,E.jsx)(C.Secondary,{disabled:l,onClick:m,ariaLabel:t("Recheck device"),children:l?(0,E.jsx)(x,{className:Y.recheckingContainer,children:(0,E.jsx)(Un,{variant:"indeterminate"})}):t("Recheck")}),(0,E.jsx)(C.Tertiary,{disabled:l,onClick:r,ariaLabel:t("Fix later"),children:t("Fix later")})]})]})};var vr=a(c()),ia=({accountUuid:n,initialDeviceHealth:e,setInitialDeviceHealth:o,blockedPage:i})=>{let r=(0,Jn.useContext)(b),s=(0,Jn.useContext)(B),l=new URLSearchParams(window.location.search).get("notificationId"),{deviceHealth:m,getDeviceHealth:_}=de(),[d,g]=(0,Jn.useState)(),p=r("Something isn't right. Please try again. If the problem persists, contact your administrator"),S=(0,Jn.useCallback)(u=>{if(!u)return;let y=new Date,A=new Date(u);if(Zi(y,A))return r("Will block today");let P=Qi(y,A);return r("Will block in {daysBlocked, plural, =1 {# day} other {# days}}",{daysBlocked:P})},[r]),R=m?.failingChecks?m?.failingChecks.filter(u=>u.status==="will_block"||u.status==="notify").map(u=>({id:u.id,title:u.title,icon:u.iconUrl,fixUrl:u.endUserUrl,blockDate:S(u?.blocksDeviceAt)})):[],w=e&&m?e?.failingChecks.filter(({id:u})=>!m?.failingChecks.some(({id:y})=>u===y)).filter(u=>u.status==="will_block"||u.status==="notify").map(u=>({id:u.id,title:u.title,icon:u.iconUrl})):[],N=r("Fix {count, plural, =1 {# issue} other {# issues}} to keep {appName} access",{appName:i||"",count:R.length||0});(0,Jn.useEffect)(()=>{_(),d&&d!==p&&g(R.length>0?r("{count, plural, =1{# issue remains} other{# issues remain}}",{count:R.length}):void 0)},[r,d,p,_,R.length]);let U=(0,Jn.useCallback)(()=>{k("ignore-device-trust-warning",void 0),k("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_WARNING_IGNORE_BUTTON"}}),s.deleteNotification()},[]),H=async()=>{k("record-click-event",{accountUuid:n,event:{componentType:"notification",category:"app",source:"notification",componentName:"DT4A_WARNING_RECHECK_BUTTON"}});let u=await k("recheck-device",{deviceStatus:"will_block",activeNotificationId:l});if(!u.ok||u.data.type==="failure"){g(p);return}let{health:y}=u.data.data;if(y.device.status!=="will_block"&&y.device.status!=="notify")return;let A=y.failingChecks.filter(P=>P.status==="will_block"||P.status==="notify");g(A.length>0?r("{count, plural, =1{# issue remains} other{# issues remain}}",{count:A.length}):void 0),o(void 0)};return(0,vr.jsx)(D,{onClose:U,title:N,type:"deviceTrustNonBlocking",hideCloseButton:!0,closeOnBackForwardCacheLoad:!1,accountUuid:n,children:(0,vr.jsx)(ra,{accountUuid:n,recheckDevice:H,reasons:R,resolvedIssues:w,ignoreWarningNotification:U,errorMessage:d})})};var Qn=a(h());var aa=a(h());var ye=a(c()),ta=({success:n})=>{let e=(0,aa.useContext)(b);return n.device&&n.icon?(0,ye.jsx)(v,{direction:"column",children:(0,ye.jsx)(v,{gap:"small",direction:"row",wrap:"nowrap",children:(0,ye.jsx)(x,{className:Y.reasonsListContainer_individual,width:"full",children:(0,ye.jsxs)(x,{padding:"medium",backgroundColor:"neutral",borderRadius:"medium",borderColor:"neutral",borderWidth:"1px",borderStyle:"solid",flexGrow:"1",display:"flex",alignItems:"center",justifyContent:"space-between",className:Y.successNotification,children:[(0,ye.jsx)(Vn,{label:n.device,icon:{size:"medium",sources:[{type:"RichIcon",content:{url:n.icon}}]}}),(0,ye.jsx)(Mr.Success.Strong,{children:e("All good")})]})})})}):null};var wr=a(c()),sa=n=>{let e=(0,Qn.useContext)(b),o=(0,Qn.useContext)(B),i=(0,Qn.useRef)(null),{deviceHealth:r,getDeviceHealth:s}=de();(0,Qn.useEffect)(()=>{s()},[s]);let t=(0,Qn.useCallback)(()=>{o.deleteNotification()},[]),l=e("All issues resolved");return(0,Qn.useEffect)(()=>{i.current=setTimeout(()=>t(),3500)},[t]),r?(0,wr.jsx)(D,{onClose:t,title:l,autoFocus:!0,type:"deviceTrustSuccess",closeOnBackForwardCacheLoad:!1,accountUuid:n.accountUuid,children:(0,wr.jsx)(ta,{success:{icon:r?.device.hardwareImageUrl,device:r?.device.name}})}):null};var la=72e6,da=n=>n?Cr({startTime:n,duration:la}):!0,_a=n=>n?Br({startTime:n,duration:la}):!1;var Vo=a(h());var ot=(n,e)=>{let{notificationConfig:o,deviceHealth:i,locked:r}=e,s=o.type,t=o.params;return!r&&s==="deviceTrustNeedsUnlock"&&!n?{action:"replace",data:{type:"deviceTrustNoKolide",params:t}}:!n&&!i?{action:"none"}:!n&&i?{action:"replace",data:{type:"deviceTrustNoKolide",params:t}}:(n?.device.status==="good"||n?.failingChecks.length===0)&&s!=="deviceTrustSuccess"?{action:"replace",data:{type:"deviceTrustSuccess",params:t}}:n?.device.status==="blocked"&&s!=="deviceTrustBlocking"?{action:"replace",data:{type:"deviceTrustBlocking",params:t}}:(n?.device.status==="will_block"||n?.device.status==="notify")&&s==="deviceTrustBlocking"&&_a(n.ignoredAt)?{action:"dismiss"}:(n?.device.status==="will_block"||n?.device.status==="notify")&&s!=="deviceTrustNonBlocking"&&s!=="deviceTrustNoKolide"&&da(n.ignoredAt)?{action:"replace",data:{type:"deviceTrustNonBlocking",params:t}}:{action:"none"}},ca=(n,e,o,i,r,s,t)=>{let l=(0,Vo.useContext)(T);(0,Vo.useEffect)(()=>{if(!o)return;let m=ot(e,{notificationConfig:{type:n,params:r},deviceHealth:i,locked:s});switch(m.action){case"replace":if(`${m.data.type}${e?.device.status}${n}`,t){k("show-notification",{type:m.data.type,params:m.data.params}).then(_=>{_.ok&&k("delete-notifications-by-type",{type:n})});break}l.replaceNotification(o,{type:m.data.type,params:m.data.params});break;case"dismiss":if(`${e?.device.status}${n}${e?.ignoredAt}`,t){k("delete-notifications-by-type",{type:n});break}l.hideNotification(o);break;case"none":`${e?.device.status}${n}`;break;default:_o(m,co`notificationTransition`);break}},[n,e,o,l,r,i,s,t])};var oo=a(c()),Ln=({type:n})=>{let e=(0,re.useContext)(F),{locked:o}=zn(e.locked),i=(0,re.useContext)(B),r=i.notification?.params,s=new URLSearchParams(window.location.search),t=s.get("notificationId"),l=Fo(r,s,"blockedPage"),m=Fo(r,s,"accountUuid"),_=Fo(r,s,"accountName"),{deviceHealth:d}=de(),[g,p]=(0,re.useState)(d),S=(0,re.useMemo)(()=>({blockedPage:l,accountUuid:m,accountName:_}),[l,m,_]);if(ca(n,d,t,g,S,o,i.notification),(0,re.useEffect)(()=>{!d&&g&&p(void 0),!na(d?.failingChecks,g?.failingChecks)&&!g&&p(d)},[t,d,g]),!m)return ea(Tr("missing account uuid in notification rendering")),null;switch(n){case"deviceTrustBlocking":return(0,oo.jsx)(Ki,{accountUuid:m,initialDeviceHealth:g,setInitialDeviceHealth:p,blockedPage:l},n);case"deviceTrustNonBlocking":return(0,oo.jsx)(ia,{accountUuid:m,initialDeviceHealth:g,setInitialDeviceHealth:p,blockedPage:l},n);case"deviceTrustSuccess":return(0,oo.jsx)(sa,{accountUuid:m},n);case"deviceTrustNoKolide":case"deviceTrustNeedsUnlock":return(0,oo.jsx)(Ji,{accountUuid:m,locked:o,cause:n,deviceHealth:d,blockedPage:l,accountName:_},n);default:return _o(n,co`notificationType`),null}};var An=a(h());var Pn=a(c()),Go=({notificationType:n})=>{let e=(0,An.useContext)(b),o=(0,An.useContext)(T),i=(0,An.useContext)(F),[r,s]=(0,An.useState)("default"),t=(0,An.useContext)(B),l=d=>{switch(d){case"generatedPasswordUserOffline":return e("Connect to the internet and then try again.");case"generatedPasswordNoDefaultSavingLocation":return e("Contact support for help, and tell them it's a problem with the default account.");case"generatedPasswordNoVaultFound":return e("Contact support for help, and tell them it's a problem with the generated password vault.");case"generatedPasswordAccountIsLocked":return e("Your {accountName} account needs to be unlocked to fill this password. Unlock it and try again.",{accountName:r});case"generatedPasswordUnexpectedError":default:return e("We're unable to use the suggested password as an unexpected error occurred.")}},m=!(n==="generatedPasswordNotSignedIn"||i.connectivityStatus==="offlineAuthenticationFailed"),_=(0,An.useCallback)(()=>{k("lock",void 0),t.deleteNotification()},[t]);return(0,An.useEffect)(()=>{o.getDefaultAccountInfo().then(d=>{d&&s(d.name)})},[o]),(0,An.useEffect)(()=>{if(n==="generatedPasswordUserOffline"&&i.connectivityStatus==="networkOffline"){let d=()=>t.deleteNotification();return window.addEventListener("online",d),()=>{window.removeEventListener("online",d)}}},[t,n,i.connectivityStatus]),(0,Pn.jsxs)(D,{type:n,title:e("Unable to fill password"),children:[m&&(0,Pn.jsx)(I.Medium,{as:"p",children:l(n)}),(n==="generatedPasswordNotSignedIn"||n==="generatedPasswordUserOffline"&&i.connectivityStatus==="offlineAuthenticationFailed")&&(0,Pn.jsxs)(Pn.Fragment,{children:[(0,Pn.jsx)(I.Medium,{as:"p",children:e("Try locking and then unlocking 1Password to fill again.")}),(0,Pn.jsx)(x,{display:"flex",flexDirection:"row-reverse",gap:"medium",marginTop:"small",children:(0,Pn.jsx)(C.Primary,{width:"full",onClick:_,children:e("Lock")})})]}),(n==="generatedPasswordNoDefaultSavingLocation"||n==="generatedPasswordNoVaultFound")&&(0,Pn.jsx)(x,{display:"flex",flexDirection:"row-reverse",gap:"medium",marginTop:"small",children:(0,Pn.jsx)(C.Primary,{width:"full",onClick:d=>{window.location.href="mailto:support@1password.com",d.preventDefault()},children:e("Contact Support")})})]})};var Ir=a($e());var K=a(h());var ma=a(h()),rt=()=>{let e=new URLSearchParams(window.location.search).get("maxNotificationHeight");if(!e)return 400;let o=parseInt(e,10);return isNaN(o)?400:o},it=()=>document.getElementById("notification-title-bar")?.offsetHeight??0,pa=()=>{let[n,e]=(0,ma.useState)(rt());return ln("max-notification-height-changed",o=>{e(o.newHeight)},[]),n-it()};var to=a(h());var va=a(h());var fn=a(h());var Me={nestedItemListHeader:"av",nestedItemListHeaderText:"lv",nestedItemList:"tv",nestedListItem:"Qi",nestedListItemDetails:"nt"};var Wn=a(c()),Ko=({icon:n,primaryText:e,secondaryText:o})=>(0,Wn.jsxs)("div",{className:Me.nestedItemListHeader,children:[(0,Wn.jsx)(cn,{...n,size:"medium"}),(0,Wn.jsxs)("div",{className:Me.nestedItemListHeaderText,children:[(0,Wn.jsx)(Xe,{component:"span",size:Vr.HeaderXs,children:e}),(0,Wn.jsx)(Xe,{color:Fr.Secondary,children:o})]})]}),$o=({children:n})=>(0,Wn.jsx)("ul",{className:Me.nestedItemList,children:n}),Xo=({action:n,icon:e,subtitle:o,title:i})=>(0,Wn.jsx)("li",{className:Me.nestedListItem,children:(0,Wn.jsxs)("div",{className:Me.nestedListItemDetails,children:[(0,Wn.jsx)(Vn,{icon:{...e,size:"medium"},label:i,secondaryLabel:o}),n]})});var In=a(c()),tt={config:void 0,canRequestUnlock:void 0,waitForUnlock:!1,error:!1};function st(n,e){switch(e.type){case"config":return{...n,error:!1,config:e.data};case"can-request-unlock":return{...n,canRequestUnlock:e.data};case"wait-for-unlock":return{...n,waitForUnlock:e.data};case"error":return{...n,error:e.data};default:te(e)}}var Yo=()=>{let[n,e]=(0,fn.useReducer)(st,tt),o=(0,fn.useContext)(T),i=(0,fn.useContext)(F),r=(0,fn.useContext)(b),s=(0,fn.useContext)(B),t=(0,fn.useCallback)(()=>{e({type:"error",data:!1}),k("uso-cancel-session",void 0),s.deleteNotification()},[s]),l=(0,fn.useCallback)(async()=>{try{await k("uso-complete-session",void 0),s.deleteNotification()}catch{e({type:"error",data:!0})}},[s]);(0,fn.useEffect)(()=>{k("uso-save-configuration",void 0).then(d=>{d.ok?e({type:"config",data:d.data}):e({type:"error",data:!0})})},[]),(0,fn.useEffect)(()=>{let d=!1,g=async()=>{let p=await o.canRequestUnlock();d||e({type:"can-request-unlock",data:p})};return i.locked&&g(),()=>{d=!0}},[o,i.locked]),(0,fn.useEffect)(()=>{!i.locked&&n.waitForUnlock&&l()},[i.locked,n.waitForUnlock,l]);let m=dn("b5x-filling-saving-telemetry"),_=(0,fn.useCallback)(()=>{i.locked?(e({type:"wait-for-unlock",data:!0}),k("request-managed-unlock",void 0)):(m()&&k("record-click-event-first-account",{event:{componentType:"button",category:"login",source:"notification",componentName:"SOCIAL_LOGIN_SAVE"}}),l())},[i.locked,l,e,m]);return n.config?(0,In.jsxs)(D,{type:"saveSocialLogin",onClose:t,title:r("Save in 1Password?"),children:[(0,In.jsx)(Ko,{icon:n.config.providerIcon,primaryText:n.config.providerDisplayString,secondaryText:r("{provider} was used to sign in to:",{provider:""})}),(0,In.jsx)($o,{children:(0,In.jsx)(Xo,{action:(!i.locked||n.canRequestUnlock?.name==="yes")&&(0,In.jsx)(C.Primary,{onClick:_,disabled:n.error,children:i.locked&&n.canRequestUnlock?.name==="yes"?r("Unlock to Save"):r("Save item")}),icon:n.config.icon,title:n.config.title})}),n.error&&(0,In.jsx)(x,{paddingBlockStart:"large",children:(0,In.jsx)(on.Critical,{title:r("Failed to save item."),children:(0,In.jsx)(on.Content,{children:r("An unexpected error occurred. Please contact support@1password.com")})})}),i.locked&&n.canRequestUnlock?.name!=="yes"&&(0,In.jsx)(x,{paddingBlockStart:"large",children:(0,In.jsx)(on.Warning,{title:r("1Password is locked"),children:(0,In.jsx)(on.Content,{children:r("Press the 1Password icon in your browser's toolbar to unlock.")})})})]}):null};var qn=a(h());var Se=a(c()),lt=n=>({MacOSX:n("Touch ID or Apple Watch"),Linux:n("system authentication"),Windows:n("Windows Hello")}),We=({success:n})=>{let e=(0,qn.useContext)(b),o=(0,qn.useContext)(T),[i,r]=(0,qn.useState)(),s=(0,qn.useContext)(B),t=(0,qn.useCallback)(()=>{o.dismissShellPluginsNotification(!n),s.deleteNotification()},[o,n,s]),l=(0,qn.useCallback)(()=>{s.deleteNotification()},[o,s]),m=(0,qn.useCallback)(()=>{i&&(window.open(i.learnMoreUrl),s.deleteNotification())},[o,i,s]);if((0,qn.useEffect)(()=>{o.shellPluginsNotificationConfig(!n).then(r).catch(l)},[o,l,n]),!i)return null;let _=lt(e),d=n?e("{credentialName} saved in 1Password",{credentialName:i.credentialName}):e("1Password Shell Plugin available for {platformName}",{platformName:i.platformName}),g=n?e("Use 1Password to authenticate {platformName} CLI with {authType}.",{platformName:i.platformName,authType:_[i.operatingSystem]??_.Linux}):e("Store your {credentialName} in 1Password and authenticate {platformName} CLI with {authType}.",{platformName:i.platformName,credentialName:i.credentialName,authType:_[i.operatingSystem]??_.Linux});return(0,Se.jsx)(D,{type:"sshOnboardingNextSteps",title:d,children:(0,Se.jsxs)(xn,{gap:"medium",children:[(0,Se.jsx)(I.Medium,{as:"p",children:g}),(0,Se.jsxs)(x,{display:"flex",flexDirection:"row-reverse",gap:"medium",children:[(0,Se.jsx)(C.Primary,{width:"full",onClick:m,children:e("Learn more\u2026")}),n?void 0:(0,Se.jsx)(C.Secondary,{width:"full",onClick:t,children:e("Dismiss")})]})]})})};var Cn=a(h());var Zn=a(c()),Jo=()=>{let[n,e]=(0,Cn.useState)(),[o,i]=(0,Cn.useState)(),r=(0,Cn.useContext)(T),s=(0,Cn.useContext)(F),t=(0,Cn.useContext)(b),l=(0,Cn.useContext)(B);(0,Cn.useEffect)(()=>{r.shellPluginsNotificationConfig(!1).then(i),r.canRequestUnlock().then(e)},[r,s.locked]);let m=(0,Cn.useCallback)(()=>{s.locked?k("request-managed-unlock",void 0):r.triggerItemSavingPrompt().then(()=>l.deleteNotification())},[r,s.locked,l]),_=(0,Cn.useCallback)(()=>{r.dismissShellPluginsNotification(!1),l.deleteNotification()},[r,l]);return!o||!n?null:(0,Zn.jsx)(D,{type:"shellPlugins",title:t("Save in 1Password?"),children:(0,Zn.jsxs)(xn,{gap:"medium",children:[(0,Zn.jsxs)(I.Medium,{as:"label",children:[o.platformName," ",o.credentialName]}),!s.locked||n?.name==="yes"?(0,Zn.jsxs)(x,{display:"flex",flexDirection:"row-reverse",gap:"medium",children:[(0,Zn.jsx)(C.Primary,{width:"full",onClick:m,children:s.locked?t("Unlock to save"):t("Save item")}),!s.locked&&(0,Zn.jsx)(C.Secondary,{width:"full",onClick:_,children:t("Dismiss")})]}):(0,Zn.jsx)(on.Warning,{title:t("1Password is locked"),children:(0,Zn.jsx)(on.Content,{children:t("Press the 1Password icon in your browser's toolbar to unlock.")})})]})})};var ka=a(h());var yr=a(c()),Qo=()=>{let n=(0,ka.useContext)(b);return(0,yr.jsx)(D,{type:"signInTo1Password",title:n("Sign in to 1Password"),children:(0,yr.jsx)(Xe,{children:n("Please sign in to 1Password to keep yourself safe online and make it easy to save and fill your passwords.")})})};var On=a(h());var Ie=a(c()),Zo=()=>{let n=(0,On.useContext)(b),e=(0,On.useContext)(T),o=(0,On.useContext)(B),[i,r]=(0,On.useState)(),s=(0,On.useCallback)(()=>{k("dismiss-ssh-onboarding",void 0),o.deleteNotification()},[o]),t=(0,On.useCallback)(()=>{e.sshOnboardingOnConfirm()},[e]);return(0,On.useEffect)(()=>{e.sshOnboardingNextStepsConfiguration().then(r).catch(s)},[e,s]),i?(0,Ie.jsxs)(D,{type:"sshOnboardingNextSteps",onClose:s,title:n("Next step: Set up SSH Agent"),children:[(0,Ie.jsx)(I,{as:"p",variant:"medium",children:i.isConnectedToOp8?n("SSH key created. To use this key locally, set up the 1Password SSH agent."):n("SSH key created. To use this key locally, set up the 1Password SSH Agent, available on 1Password 8.")}),(0,Ie.jsx)("div",{children:(0,Ie.jsx)("a",{href:i.learnMoreUrl,target:"_blank",rel:"noopener noreferrer",children:n("Learn more\u2026")})}),(0,Ie.jsx)(v,{width:"full",paddingTop:"small",children:(0,Ie.jsx)(C,{width:"full",variant:"primary",onClick:t,children:i.isConnectedToOp8?n("Set up SSH Agent"):n("Download 1Password 8")})})]}):null};var Bn=a(h());var nr={multiSelectionContainer:"sv",itemSection:"zm",lockBanner:"_v",unstyledList:"dv"};var nn=a(c()),er=()=>{let[n,e]=(0,Bn.useState)(),o=(0,Bn.useContext)(F),i=(0,Bn.useContext)(B),r=(0,Bn.useContext)(b),s=dn("b5x-sign-in-with-improvements"),t=(0,Bn.useCallback)(()=>{k("uso-prompt-configuration",void 0).then(_=>{if(!_.ok){console.error("[Sign in with] Failed to get configuration."),i.deleteNotification();return}if(_.data.accounts.length===0&&!_.data.managedApp){i.deleteNotification();return}e(_.data)})},[i]);(0,Bn.useEffect)(()=>t(),[t]),(0,Bn.useEffect)(()=>{o.locked?e({accounts:[]}):t()},[t,o.locked]),ln("sign-in-with-button-detected",t,[]);let l=dn("b5x-filling-saving-telemetry"),m=(0,Bn.useCallback)(_=>{l()&&k("record-click-event-first-account",{event:{componentType:"button",category:"login",source:"notification",componentName:"SOCIAL_LOGIN_SIGNIN"}}),_.clickProvider&&k("uso-click-provider",_.clickProvider),i.deleteNotification()},[i,l]);return n?(0,nn.jsx)(D,{type:"suggestSocialLogin",title:r("Sign in with\u2026"),children:(0,nn.jsx)(x,{display:"flex",className:nr.multiSelectionContainer,children:(0,nn.jsx)(bn,{elevateOnScroll:"top",thin:!0,children:(0,nn.jsxs)(xn,{gap:"small",children:[s()&&n.managedApp&&(0,nn.jsx)(_t,{...n.managedApp}),n.accounts.length>0&&(0,nn.jsx)("ul",{className:nr.unstyledList,children:n.accounts.map(_=>(0,nn.jsxs)("li",{className:nr.itemSection,children:[(0,nn.jsx)(Ko,{icon:_.icon,primaryText:_.title,secondaryText:r("{item} is linked to:",{item:""})}),(0,nn.jsx)($o,{children:_.items.map(d=>(0,nn.jsx)(Xo,{action:(0,nn.jsx)(Ce,{disabled:!d.clickProvider,mode:"primary",onClick:()=>m(d),"aria-label":r("Sign in using {title}: {subtitle}",{title:d.title??"",subtitle:d.subtitle??""}),children:r("Sign in")}),icon:d.icon,subtitle:d.subtitle,title:d.title},d.title+d.subtitle))})]},_.title))}),!o.locked&&n.accounts.length===0&&!n.managedApp&&(0,nn.jsx)(Hn,{icon:{id:"info",sources:[{type:"ThemedIcon",content:{file:En.Information}}]},role:"status",variant:"info",children:r("No items found to sign in with.")}),o.locked&&(0,nn.jsx)(Hn,{icon:{id:"locked",sources:[{type:"ThemedIcon",content:{file:En.Lock}}]},role:"status",variant:"info",children:r("Press the 1Password icon in your browser's toolbar to unlock.")})]})})})}):null},_t=n=>{let e=(0,Bn.useContext)(b);return(0,nn.jsxs)(v,{borderWidth:"1px",borderStyle:"solid",borderColor:"neutralWeak",borderRadius:"medium",padding:"small",gap:"small",alignItems:"center",children:[(0,nn.jsx)(cn,{size:"medium",shape:mo.RoundedRect,...n.icon}),(0,nn.jsxs)(x,{children:[(0,nn.jsx)(I,{as:"p",variant:"medium",children:n.name}),(0,nn.jsx)(I,{as:"label",variant:"small",color:"neutralWeak",children:e("Managed by Trelica")})]}),(0,nn.jsx)(x,{marginLeft:"auto",children:(0,nn.jsx)(Ce,{mode:"primary",onClick:()=>{k("uso-click-managed-app",n)},children:e("Sign in")})})]})};var ao=a(h());var xa=a(h()),Oe=a(c()),Te=({type:n="generic",onAction:e})=>{let o=(0,xa.useContext)(b),i=n==="missing-item";return(0,Oe.jsx)(Hn,{icon:{id:"error-callout-banner-icon",sources:[{type:"ThemedIcon",content:{file:i?En.Information:En.Warning}}]},role:i?"status":"alert",variant:i?"info":"warning",children:(0,Oe.jsxs)(v,{alignItems:"flex-start",direction:"column",gap:"small",children:[(0,Oe.jsxs)(I,{as:"p",variant:"medium",color:i?"brand":"critical",children:[n==="timeout"&&o("The request to create a passkey timed out."),n==="missing-item"&&o("No passkeys found"),n!=="timeout"&&n!=="missing-item"&&o("1Password encountered a problem.")]}),n!=="missing-item"&&(0,Oe.jsx)(Ce,{mode:i?"accent":"destructiveAlt",onClick:()=>e(),children:o("Try Again")})]})})};var tn=a(h());var Fe=a(h());var or=(n,e,o,i)=>{let r=(0,Fe.useRef)(e),[s,t]=(0,Fe.useState)();return(0,Fe.useEffect)(()=>{let l=o?sr.assertLogSafe(o):void 0,m=Zr(sr.assertLogSafe(n),{reqId:l,reconnect:i},t),_=d=>{r.current(d,m.postMessage)};return t(m),m.onMessage.addListener(_),()=>{m.onMessage.removeListener(_);try{m.disconnect()}catch{}}},[n,o,i]),{postMessage:l=>{try{if(`${n}`,l.type,!s)throw new Error;s.postMessage(l)}catch{console.error(".postMessage failed. Port has likely been disconnected")}},close:()=>{try{if(!s)throw new Error;s.disconnect()}catch{`${n}`}}}};var ga=a(h()),ie=a(c()),rr=({canRequestUnlock:n,type:e,onClick:o})=>{let i=(0,ga.useContext)(b);return(0,ie.jsx)(ie.Fragment,{children:(0,ie.jsx)(Hn,{icon:{id:"unlock-callout-banner-icon",sources:[{type:"ThemedIcon",content:{file:En.Lock}}]},role:"status",variant:"info",children:n?(0,ie.jsxs)(v,{alignItems:"flex-start",direction:"column",gap:"small",children:[(0,ie.jsx)(I,{as:"p",variant:"medium",color:"brand",children:i(e==="save"?"To save a passkey, unlock 1Password first.":"To use your passkey, unlock 1Password first.")}),(0,ie.jsx)(C.Primary,{onClick:o,children:i("Unlock 1Password")})]}):i("Select the 1Password icon in your browser's toolbar to unlock.")})})};var Dn=a(c()),ua=()=>{let n=(0,tn.useContext)(b),e=(0,tn.useContext)(T),o=(0,tn.useContext)(F),r=new URLSearchParams(window.location.search).get("notificationId"),[s,t]=(0,tn.useState)(o),{locked:l,requestUnlockStatus:m,wasLockedNowUnlocked:_,wasUnlockedNowLocked:d}=zn(s.locked),[g,p]=(0,tn.useState)({state:"unset"}),[S,R]=(0,tn.useState)(),w=typeof S<"u",N=S==="timeout",U=g.state==="register-success"&&!w,H=!0,u=(0,tn.useCallback)(()=>{p(f=>f.state==="unset"?f:{state:"preview",preview:f.preview})},[]),y=(0,tn.useRef)(null),A=(0,tn.useCallback)(({type:f,data:L})=>{f==="locked-preview-passkey-data"&&p({state:"preview",preview:{username:L.username,title:L.title,icon:L.icon}}),f==="new-passkey-data"&&p(sn=>{let W={username:L.username,title:L.title,icon:L.icon,vaults:L.vaultListElements,selectedVault:L.defaultSuggestedVaultId};return{state:"pending-update",preview:sn?.preview,new:W}}),f==="passkey-register-success"&&(p({state:"register-success",preview:{username:L.username,title:L.title,icon:L.icon}}),y.current=setTimeout($,3500)),f==="update-passkey-data"&&p(sn=>({state:"hydrated",preview:sn?.preview,new:sn?.new,update:L})),f==="error"&&R(L.loggableReason),f==="b5x-unlocked"&&t(sn=>({...sn,locked:!1})),f==="b5x-locked"&&t(sn=>({...sn,locked:!0}))},[]),P=or("passkey-save-prompt",A,r,H),$=(0,tn.useCallback)(()=>{P.close(),e.hideNotification(r??void 0)},[P,e,r]),M=(0,tn.useCallback)(()=>{k("request-managed-unlock",void 0)},[]);(0,tn.useEffect)(()=>{if(_){P.postMessage({type:"passkey-unlocked",data:{}});return}d&&(P.postMessage({type:"passkey-locked",data:{}}),u())},[P,u,_,d]);let G=dn("b5x-filling-saving-telemetry"),en=(0,tn.useCallback)(f=>{try{G()&&k("record-click-event-first-account",{event:{componentType:"button",category:"login",source:"notification",componentName:f}})}catch{console.error("[SavePasskey] Error reporting telemetry event.")}},[G]),yn=(0,tn.useCallback)(f=>{en("PASSKEY_SAVE"),P.postMessage({type:"new-passkey-save",data:{accountVaultUuid:f}})},[P,en]),q=(0,tn.useCallback)(f=>{en("PASSKEY_UPDATE"),P.postMessage({type:"update-passkey-save",data:{id:f}})},[P,en]);return(0,Dn.jsx)(ke,{fullscreen:!0,onClose:P.close,title:n(U?"Passkey saved":"Save passkey"),autoFocus:!0,type:"passkeySavePrompt",closeOnBackForwardCacheLoad:!H,actions:U?void 0:[{onClick:()=>{P.postMessage({type:"use-system-passkeys",data:{}}),$()},disabled:N,label:n("Use a security key or another passkey"),useTooltip:!N,icon:(0,Dn.jsx)(xo,{})}],children:(0,Dn.jsx)(xe,{children:(0,Dn.jsxs)(v,{direction:"column",gap:"medium",children:[U&&(0,Dn.jsx)(Ao,{title:g.preview.title,username:g.preview.username,icon:g.preview.icon,rowEndElement:(0,Dn.jsx)(Pe,{color:"success"})}),g.state==="hydrated"&&!l&&(0,Dn.jsx)(Ho,{vaultItemRowProps:{rowEndElement:(0,Dn.jsx)(Pe,{color:w||l?"disabled":"attention"}),color:"attention"},isDisabled:w||l,updateableItems:g.update,newItem:g.new,onSave:yn,onUpdate:q}),(l||g.state!=="hydrated"&&g.state!=="register-success")&&!w&&(0,Dn.jsx)(rr,{canRequestUnlock:m?m==="connected":void 0,type:"save",onClick:M}),w?(0,Dn.jsx)(Te,{onAction:$,type:S==="timeout"?"timeout":void 0}):null]})})})};var J=a(h());var ir=a(h());var ro={passkeyItem:"mv",multiSelectionContainer:"xv",optionsContainer:"Re",listButton:"Sm"};var V=a(c()),fa=({options:n,onSelect:e,onSubmit:o})=>{let i=(0,ir.useContext)(b),r=go("--knox-background-attention")??void 0,s=go("--knox-background-attention-hover")??void 0,t=go("--knox-background-attention-pressed")??void 0,l=n.length===1,m=_=>(0,V.jsx)(Vn,{className:ro.passkeyItem,label:_.title,secondaryLabel:_.username,icon:{size:"medium",sources:_.icon.sources,id:_.icon.id,shape:_.icon.shape}});return(0,ir.useEffect)(()=>{l&&e(n[0].localId)},[l,e,n]),(0,V.jsx)(V.Fragment,{children:l?(0,V.jsxs)(mr,{gradient:"purple",borderColor:"neutral",children:[(0,V.jsx)(x,{paddingRight:"small",children:m(n[0])}),(0,V.jsx)(x,{flexShrink:"0",children:(0,V.jsx)(Or,{variables:{button:{primary:{background:r,backgroundHover:s,backgroundPressed:t}}},children:(0,V.jsx)(C.Primary,{onClick:()=>o(n[0].localId),children:(0,V.jsx)(x,{paddingX:"xs",children:(0,V.jsxs)(v,{gap:"xs",padding:"hairline",children:[(0,V.jsx)(Pe,{color:"inverse"}),(0,V.jsx)(I.Medium,{color:"inverse",as:"span",children:i("Sign in")})]})})})})})]},n[0].localId):(0,V.jsx)(x,{display:"flex",className:ro.multiSelectionContainer,children:(0,V.jsx)(bn,{elevateOnScroll:"top",thin:!0,children:(0,V.jsx)("ul",{className:ro.optionsContainer,children:n.map(_=>(0,V.jsx)("li",{children:(0,V.jsx)("button",{className:ro.listButton,onClick:()=>o(_.localId),children:(0,V.jsxs)(mr,{hoverGradient:"purple",children:[(0,V.jsx)(x,{paddingRight:"small",textAlign:"start",flexGrow:"1",width:"min-content",children:m(_)}),(0,V.jsxs)(v,{gap:"small",children:[(0,V.jsx)(Pe,{color:"attention"}),(0,V.jsx)(Dr,{color:"neutral"})]})]})})},_.localId))})})})})};var ae=a(c()),ba=()=>{let n=(0,J.useContext)(F),e=new URLSearchParams(window.location.search),i=e.get("mediation")!=="conditional",r=e.get("notificationId"),[s,t]=(0,J.useState)(n),[l,m]=(0,J.useState)(),[_,d]=(0,J.useState)(),g=l==="timeout",[p,S]=(0,J.useState)(),[R,w]=(0,J.useState)(),N=(0,J.useRef)(!1),U=(0,J.useRef)(null),{locked:H,requestUnlockStatus:u,wasLockedNowUnlocked:y,wasUnlockedNowLocked:A}=zn(s.locked),P=(0,J.useContext)(T),$=(0,J.useContext)(b),M=!1,G=or("passkey-signin-prompt",W=>{W.type==="sign-in-with-passkey"&&S(W.data.options),W.type==="sign-in-success"&&f(),W.type==="error"&&(W.data.loggableReason==="missing-item"?d(W.data.loggableReason):m(W.data.loggableReason)),W.type==="b5x-unlocked"&&t(Ge=>({...Ge,locked:!1})),W.type==="b5x-locked"&&(d(void 0),S(void 0),t(Ge=>({...Ge,locked:!0})))},r,M),en=(0,J.useCallback)(()=>{k("request-managed-unlock",void 0)},[]),yn=dn("b5x-filling-saving-telemetry"),q=(0,J.useCallback)(W=>{yn()&&k("record-click-event-first-account",{event:{componentType:"button",category:"login",source:"notification",componentName:"PASSKEY_SIGNIN"}}),G.postMessage({type:"select-passkey-item",data:{localId:W}})},[G,yn]),f=(0,J.useCallback)(()=>{G.close(),P.hideNotification(r??void 0)},[G,P,r]),L=(0,J.useCallback)(()=>{if(!N.current){if(H){en();return}typeof R=="number"&&(q(R),f())}},[H,en,q,R,f]);(0,J.useEffect)(()=>{A&&G.postMessage({type:"passkey-locked",data:{}})},[G,A]),(0,J.useEffect)(()=>{y&&(G.postMessage({type:"passkey-unlocked",data:{}}),N.current=!1)},[G,y]);let sn=(0,J.useCallback)(W=>{if(W.key==="Tab"){N.current=!0;return}W.key==="Enter"&&L()},[L]);return(0,J.useEffect)(()=>{let W=U.current;if(W!==null)return W.addEventListener("keydown",sn),()=>{W!==null&&W.removeEventListener("keydown",sn)}},[sn]),(0,ae.jsx)(ke,{onClose:G.close,autoFocus:i||y||!!p,type:"passkeySigningIn",closeOnBackForwardCacheLoad:!M,actions:[{onClick:()=>{G.postMessage({type:"use-system-passkeys",data:{}}),f()},label:$("Use a security key or another passkey"),disabled:g,useTooltip:!g,icon:(0,ae.jsx)(xo,{})}],title:$("Sign in with a passkey"),ref:U,children:(0,ae.jsxs)(xe,{paddingBottom:!l&&!H&&p&&p?.length>1?"unset":void 0,children:[!l&&!_&&(H||!p||p.length===0)?(0,ae.jsx)(rr,{canRequestUnlock:u==="connected",type:"use",onClick:en}):null,!l&&!H&&p&&(0,ae.jsx)(fa,{options:p,onSelect:w,onSubmit:q}),!l&&!H&&_?(0,ae.jsx)(Te,{onAction:f,type:_==="missing-item"?_:void 0}):null,l?(0,ae.jsx)(Te,{onAction:f,type:l==="timeout"?l:void 0}):null]})})};var io=a(c()),Ve=({type:n})=>{let e=(0,ao.useContext)(T),o=(0,ao.useContext)(b),r=new URLSearchParams(window.location.search).get("notificationId"),s=(0,ao.useCallback)(()=>{e.hideNotification(r??void 0)},[e,r]);switch(n){case"register":return(0,io.jsx)(ua,{},n);case"signingin":return(0,io.jsx)(ba,{},n);case"generic_error":return(0,io.jsx)(D,{type:"passkeyGenericError",title:o("Something went wrong"),closeOnBackForwardCacheLoad:!0,children:(0,io.jsx)(Te,{type:"generic",onAction:s})},n)}};var jn=a(h());var ha="/assets/png/password-I65M5ZVL.png";var Tn=a(c()),ar=()=>{let n=(0,jn.useContext)(b),e=new URLSearchParams(window.location.search),o=(0,jn.useContext)(F),i=(0,jn.useContext)(B),r=i.notification?i.notification.params.itemUuid:e.get("itemUuid")||"",{wasUnlockedNowLocked:s,wasLockedNowUnlocked:t}=zn(o.locked),[l,m]=(0,jn.useState)(),_=(0,jn.useCallback)(()=>{k("get-item-summary",{itemUuid:r}).then(g=>{g.ok&&m(g.data)})},[]);(0,jn.useEffect)(()=>{_()},[]),(0,jn.useEffect)(()=>{s&&m(void 0),t&&_()},[s,t]);let d=(0,jn.useCallback)(()=>{k("record-click-event-all-accounts",{event:{componentType:"button",category:"item",source:"notification",componentName:"WATCHTOWER_CHANGE_PASSWORD"}}),l&&l.localId&&k("watchtower-change-password",{itemId:{type:"databaseId",data:l.localId}}),i.deleteNotification()},[i,l]);return(0,Tn.jsxs)(D,{type:"watchtowerBreachDetected",title:n("Change this compromised password"),children:[(0,Tn.jsxs)(v,{wrap:"nowrap",alignItems:"center",gap:"medium",children:[(0,Tn.jsx)(I,{as:"p",variant:"medium",children:n("A security breach on this website has put your current password at risk.")}),(0,Tn.jsx)("img",{src:ha,height:"48px",alt:""})]}),l&&(0,Tn.jsxs)(v,{borderWidth:"1px",borderStyle:"solid",borderColor:"neutralWeak",borderRadius:"medium",padding:"small",marginTop:"small",gap:"small",alignItems:"center",children:[(0,Tn.jsx)(cn,{size:"medium",shape:mo.RoundedRect,sources:l.icon}),(0,Tn.jsxs)(x,{children:[(0,Tn.jsx)(I,{as:"p",variant:"medium",children:l.title}),(0,Tn.jsx)(I,{as:"label",variant:"small",children:l.ainfo})]}),(0,Tn.jsx)(x,{marginLeft:"auto",children:(0,Tn.jsx)(Ce,{mode:"primary",onClick:d,children:n("Change now")})})]})]})};var _n=a(c()),wa=()=>{let n=(0,va.useContext)(B);if(!n.notification)return null;switch(n.notification.type){case"autosave":return(0,_n.jsx)(Mo,{});case"autosaveTotp":return(0,_n.jsx)(Uo,{});case"addAccount":return(0,_n.jsx)(Eo,{});case"suggestSocialLogin":return(0,_n.jsx)(er,{});case"shellPlugins":return(0,_n.jsx)(Jo,{});case"shellPluginsSuccess":return(0,_n.jsx)(We,{success:!0});case"shellPluginsFallback":return(0,_n.jsx)(We,{});case"sshOnboardingNextSteps":return(0,_n.jsx)(Zo,{});case"signInTo1Password":return(0,_n.jsx)(Qo,{});case"generatedPasswordUserOffline":case"generatedPasswordNoDefaultSavingLocation":case"generatedPasswordAccountIsLocked":case"generatedPasswordNotSignedIn":case"generatedPasswordNoVaultFound":case"generatedPasswordUnexpectedError":return(0,_n.jsx)(Go,{notificationType:n.notification.type});case"saveSocialLogin":return(0,_n.jsx)(Yo,{});case"watchtowerBreachDetected":return(0,_n.jsx)(ar,{});case"passkeyGenericError":return(0,_n.jsx)(Ve,{type:"generic_error"});case"deviceTrustNonBlocking":return(0,_n.jsx)(Ln,{type:"deviceTrustNonBlocking"});case"deviceTrustSuccess":return(0,_n.jsx)(Ln,{type:"deviceTrustSuccess"});case"deviceTrustBlocking":return(0,_n.jsx)(Ln,{type:"deviceTrustBlocking"});case"deviceTrustNoKolide":return(0,_n.jsx)(Ln,{type:"deviceTrustNoKolide"});case"deviceTrustNeedsUnlock":return(0,_n.jsx)(Ln,{type:"deviceTrustNeedsUnlock"});default:return null}};var so=a(c()),Sr=()=>{let n=(0,to.useContext)(b),e=(0,to.useContext)(B);return!e.notification||!e.totalNotifications||!e.maxScrollableNotifications?null:(0,so.jsxs)(to.Fragment,{children:[e.orderInStack===2&&!e.stackCollapsed&&e.totalNotifications>e.maxScrollableNotifications&&(0,so.jsx)(x,{display:"flex",justifyContent:"center",className:$n.collapseButton,borderRadius:"large",boxShadow:"topLedge",onClick:e.onCollapse,"data-testid":"collapse-button",children:n("Collapse all")}),(0,so.jsx)(wa,{})]},e.notification.id)};var ya=a(h()),Ia=a(c()),Sa=({children:n,onResize:e})=>{let[o,i]=Le();return(0,ya.useEffect)(()=>{o&&e&&e({height:o.height})},[o]),(0,Ia.jsx)("div",{ref:i,children:n})};var kn=a(c());var kt=(n,e)=>{switch(e.type){case"hydrate":return Co(e.data);case"delete":return n.filter(o=>!e.data.includes(o.id));default:return n}},tr=3,Ca=()=>{let n=(0,K.useContext)(b),e=(0,K.useContext)(T),i=new URLSearchParams(window.location.search).get("notificationId"),[r,s]=(0,K.useReducer)(kt,[]),t=pa(),[l,m]=(0,K.useState)(!1),[_,d]=(0,K.useState)(!0),[g,p]=(0,K.useState)(!1),[S,R]=(0,K.useState)(!1),[w,N]=(0,K.useState)([0,1,2]),U=(0,K.useRef)(null),[H,u]=(0,K.useState)(0),y=(0,K.useRef)(new Map),[A,P]=(0,K.useState)(0),[$,M]=(0,K.useState)(void 0),G=dn("b5x-filling-saving-telemetry"),en=()=>{P(yi(y.current))},yn=async()=>k("hydrate-notifications",void 0).then(async f=>{if(f.ok){let L=f.data,sn=L.filter(Ke=>Q[Ke.type].fullscreen);if(sn.length>0){await k("set-fullscreen-notification",{enabled:!0});let Ke=Co(sn);L=[Ke[0]],M(Ke[0].type),Q[Ke[0].type].blockPageElements&&k("set-page-inert",{enabled:!0})}let{newNotifications:W,previousNotificationsSorted:Ge,currentNotifications:Ea}=wi(r,L);W.length>0&&N(vi(Ea,Ge,W)),s({type:"hydrate",data:L})}else console.error("Unable to retrieve notifications")}).catch(()=>{console.error("Unable to retrieve notifications")}),q=(0,K.useCallback)((f,L)=>{k("delete-notification",{id:f}).then(sn=>{if(sn.ok){if(y.current.delete(f),s({type:"delete",data:[f]}),k("clear-notifications",{ids:[f]}),en(),G()){let W={componentType:"button",category:"app",source:"notification",componentName:`NOTIFICATION_DISMISS_${L}`};Ci(W)}}else console.error("Unable to delete notification with ID:",f)}).catch(()=>{console.error("Unable to delete notification with ID:",f)})},[G]);return(0,K.useEffect)(()=>void yn().finally(()=>d(!1)),[]),(0,K.useEffect)(()=>{if(!_){if(r.length===0){$?(Q[$].blockPageElements&&k("set-page-inert",{enabled:!1}),k("has-notifications",void 0).then(async f=>{f.ok&&f.data.hasNotifications?(M(void 0),await k("set-fullscreen-notification",{enabled:!1}),yn()):e.hideNotification(i??void 0)})):e.hideNotification(i??void 0);return}m(r.length>tr&&!g)}},[r]),(0,K.useLayoutEffect)(()=>{U.current&&window.requestAnimationFrame(()=>{let f=U.current?.offsetHeight??0;f&&f!==H&&u(f)})},[l,r]),ln("rehydrate-notifications",()=>{yn()},[r]),ln("clear-notifications",f=>{s({type:"delete",data:f.ids})},[]),(0,kn.jsxs)(kn.Fragment,{children:[$&&(0,kn.jsx)(uo,{className:(0,Ir.default)({[$n.blurBackground]:Q[$].blurBackground})}),(0,kn.jsx)(ke,{type:"notificationManager",title:n("Notifications"),"aria-label":n("Notifications"),children:(0,kn.jsxs)(x,{className:(0,Ir.default)($n.notificationScroller,{[$n.notificationStack]:l}),"data-testid":l?"notification-stack":"notification-scroller",onKeyDown:f=>{l&&!g&&(f.key==="ArrowDown"||f.key==="Down")?(p(!0),m(!1)):(f.key==="ArrowUp"||f.key==="Up")&&(p(!1),m(!0))},...!l&&{style:{height:Math.min(A,t),overflowY:A<t?"hidden":"scroll"}},onMouseEnter:()=>R(!0),onMouseLeave:()=>R(!1),children:[l?(0,kn.jsx)(ze,{children:r.slice(0,tr).map((f,L)=>(0,kn.jsx)(po.div,{variants:hi,custom:L,initial:"initial",animate:w.includes(L)?"animate":{opacity:1,x:0,y:0},style:{marginTop:L>0?-H:0,zIndex:r.length-L,position:"relative",scale:1-L*.05},ref:L===0?U:void 0,children:L===0?(0,kn.jsx)(Je,{state:{notification:f,deleteNotification:()=>q(f.id,f.type),stackCollapsed:l,orderInStack:L+1,totalNotifications:r.length,maxScrollableNotifications:tr,onCollapse:()=>{p(!1),m(!0)},autoFocus:Q[f.type]?.autoFocus},children:(0,kn.jsx)(Sr,{},f.id)}):(0,kn.jsx)(x,{"data-testid":"stacked-notification",className:$n.expandedNotification,style:{height:`${H-10}px`},borderRadius:"medium",boxShadow:"low",role:"alert"},f.id)},L===2?f.id:L))}):r.slice(0,r.length).map((f,L)=>(0,kn.jsx)(Je,{state:{notification:f,deleteNotification:()=>q(f.id,f.type),stackCollapsed:l,orderInStack:L+1,totalNotifications:r.length,maxScrollableNotifications:tr,onCollapse:()=>{p(!1),m(!0)},autoFocus:Q[f.type]?.autoFocus},children:(0,kn.jsx)(Sa,{onResize:({height:sn})=>{y.current.set(f.id,sn),en()},children:(0,kn.jsx)(Sr,{},f.id)})},f.id)),l&&!g&&S&&(0,kn.jsx)(x,{marginTop:"medium",className:$n.expandButton,borderRadius:"large",style:{zIndex:r.length+1},children:(0,kn.jsx)(C.Secondary,{onClick:()=>{p(!0),m(!1)},"data-testid":"expand-button",children:n("View all")})})]})})]})};import xt from"/assets/js/messages.i18n-CEVLXSMX.js";var Ba=()=>{Er(3),Rn("app-theme-changed",Nn("app-theme-changed")),Rn("update-connectivity-status",Nn("update-connectivity-status")),Rn("lock-state-changed",Nn("lock-state-changed")),Rn("accounts-and-vaults-changed",Nn("accounts-and-vaults-changed")),Rn("device-health-changed",Nn("device-health-changed")),Rn("device-trust-connected",Nn("device-trust-connected")),Rn("language-changed",Nn("language-changed")),Rn("max-notification-height-changed",Nn("max-notification-height-changed")),Rn("rehydrate-notifications",Nn("rehydrate-notifications")),Rn("clear-notifications",Nn("clear-notifications")),Rn("sign-in-with-button-detected",Nn("sign-in-with-button-detected"))};var j=a(c());document.addEventListener("DOMContentLoaded",()=>{Ba(),(0,Ta.createRoot)(document.getElementById("root")).render((0,j.jsx)(ri,{bridge:new ii(ni()),children:(0,j.jsx)(ti,{children:(0,j.jsx)(gt,{})})}))});var gt=()=>{let n=(0,Ee.useContext)(F),e=(0,Ee.useContext)(T),i=new URLSearchParams(window.location.search).get("notificationId")??void 0,r=(0,Ee.useRef)(null);return(0,Ee.useEffect)(()=>{let s=bo(window.location.hash);s!==r.current&&(r.current=s,document.body.setAttribute("data-notification-type",Q[s].fullscreen?"fullscreen":"autosized"),s==="notificationManager"&&(document.body.style.backgroundColor="transparent"))}),(0,j.jsx)(Lr,{themeOverride:n.appTheme,children:(0,j.jsx)(Yr,{children:(0,j.jsx)(Xr,{children:(0,j.jsx)($r,{children:(0,j.jsx)(Jr,{locale:n.locale,messages:xt,children:(0,j.jsx)(Je,{state:{deleteNotification:()=>{e.hideNotification(i)}},children:(0,j.jsx)(mi,{children:ut})})})})})})})},ut=n=>{switch(n){case"addAccount":return(0,j.jsx)(Eo,{});case"autosave":return(0,j.jsx)(Mo,{});case"autosaveTotp":return(0,j.jsx)(Uo,{});case"passkeySavePrompt":return(0,j.jsx)(Ve,{type:"register"});case"passkeySigningIn":return(0,j.jsx)(Ve,{type:"signingin"});case"passkeyGenericError":return(0,j.jsx)(Ve,{type:"generic_error"});case"saveSocialLogin":return(0,j.jsx)(Yo,{});case"sshOnboardingNextSteps":return(0,j.jsx)(Zo,{});case"shellPlugins":return(0,j.jsx)(Jo,{});case"shellPluginsSuccess":return(0,j.jsx)(We,{success:!0});case"shellPluginsFallback":return(0,j.jsx)(We,{});case"suggestSocialLogin":return(0,j.jsx)(er,{});case"signInTo1Password":return(0,j.jsx)(Qo,{});case"watchtowerBreachDetected":return(0,j.jsx)(ar,{});case"generatedPasswordUserOffline":case"generatedPasswordNoDefaultSavingLocation":case"generatedPasswordAccountIsLocked":case"generatedPasswordNotSignedIn":case"generatedPasswordNoVaultFound":case"generatedPasswordUnexpectedError":return(0,j.jsx)(Go,{notificationType:n});case"deviceTrustBlocking":return(0,j.jsx)(Ln,{type:"deviceTrustBlocking"});case"deviceTrustNonBlocking":return(0,j.jsx)(Ln,{type:"deviceTrustNonBlocking"});case"deviceTrustSuccess":return(0,j.jsx)(Ln,{type:"deviceTrustSuccess"});case"deviceTrustNoKolide":return(0,j.jsx)(Ln,{type:"deviceTrustNoKolide"});case"deviceTrustNeedsUnlock":return(0,j.jsx)(Ln,{type:"deviceTrustNeedsUnlock"});case"notificationManager":return(0,j.jsx)(Ca,{});default:te(n)}};

//# debugId=dd7c4fae-ea34-57fc-baa7-043291490978
